import{a as L,b as R}from"./style-b9bc59b4.js";import{D as x,a as V,c as F,P as E,b as z}from"./system-93ae242b.js";import{g as O,s as M}from"./common-938b41ea.js";import{i as c}from"./i18n-0af8b262.js";import{e as B}from"./exportTable-b0d17537.js";import{B as G}from"./btnGroup-26ff2079.js";import{a as N}from"./index-cd6d6b34.js";import U from"./sku-info-138df2f3.js";import{g as H}from"./stockAsn-18b92b84.js";import j from"./view-detail-dialog-e234b4c2.js";import{_ as J}from"./search-group.vue_vue_type_script_setup_true_lang-77ccf260.js";import Z from"./Chart-31f37ca7.js";import{d as W,b as i,r as p,o as Y,c as f,w as K,a as r,x as _,m as g,u,q as t,s as n,ap as m,as as y,y as Q,at as S,aq as X,O as ee}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./index-ae8f073f.js";import"./vue-router-1283ad2d.js";import"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./index-f9a914d4.js";import"./lodash-b35d7d50.js";const ae={class:"container"},oe={class:"operateArea"},se=["onClick"],le=W({__name:"asnStatistic",setup(ne){const h=i(),v=i(),w=i(),e=p({showDialog:!1,showDialogShowInfo:!1,searchForm:{supplier_name:"",sku_name:"",spu_code:"",spu_name:"",sku_code:"",goods_owner_name:""},activeTab:null,tableData:i([]),dialogForm:i({id:0,asn_no:"",asn_batch:"",estimated_arrival_time:"",detailList:[]}),tablePage:p({total:0,sqlTitle:"asn_status:4",pageIndex:1,pageSize:x,searchObjects:i([])}),timer:i(null),btnList:[],authorityList:O(),menu_name:"asnStatistic",currentRender:"table"}),l=p({switchRenderMode:()=>{e.currentRender==="chart"?e.currentRender="table":e.currentRender="chart"},handleSetSearch:()=>{w.value.openDialog()},closeDialogShowInfo:()=>{e.showDialogShowInfo=!1},showSkuInfo(a){e.dialogForm=JSON.parse(JSON.stringify(a)),e.showDialogShowInfo=!0},refresh:()=>{l.getStockAsnList()},getStockAsnList:async()=>{const{data:a}=await H(e.tablePage);if(!a.isSuccess){N.$message({type:"error",content:a.errorMessage});return}e.tableData=a.data.rows,e.tablePage.total=a.data.totals},handlePageChange:i(({currentPage:a,pageSize:s})=>{e.tablePage.pageIndex=a,e.tablePage.pageSize=s,l.getStockAsnList()}),exportTable:()=>{const a=h.value;B({table:a,filename:c.global.t("wms.stockAsn.tabReceiptDetails"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})},sureSearch:()=>{e.tablePage.searchObjects=M(e.searchForm),l.getStockAsnList()}});Y(()=>{});const b=f(()=>L({hasTab:!1})),I=f(()=>R({hasTab:!1})),A=f(()=>[{name:c.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:l.refresh},{name:c.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:l.exportTable},{name:c.global.t("system.page.setSearch"),icon:"mdi-cog",code:"",click:l.handleSetSearch},{name:e.currentRender!=="chart"?c.global.t("system.page.chart"):c.global.t("system.page.table"),icon:e.currentRender!=="chart"?"mdi-chart-bar":"mdi-table",code:"",click:l.switchRenderMode}]);return K(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,l.sureSearch()},V)},{deep:!0}),(a,s)=>{const k=r("v-col"),D=r("v-row"),o=r("vxe-column"),$=r("vxe-table"),P=r("v-window-item"),T=r("v-window"),q=r("v-card-text"),C=r("v-card");return _(),g(ee,null,[u("div",ae,[u("div",null,[t(C,{class:"mt-5"},{default:n(()=>[t(q,null,{default:n(()=>[t(T,{modelValue:e.activeTab,"onUpdate:modelValue":s[1]||(s[1]=d=>e.activeTab=d)},{default:n(()=>[t(P,null,{default:n(()=>[u("div",oe,[t(D,{"no-gutters":""},{default:n(()=>[t(k,{cols:"3",class:"col"},{default:n(()=>[t(G,{"authority-list":e.authorityList,"btn-list":m(A)},null,8,["authority-list","btn-list"])]),_:1}),t(k,{cols:"9"},{default:n(()=>[t(J,{ref_key:"searchGroupRef",ref:w,modelValue:e.searchForm,"onUpdate:modelValue":s[0]||(s[0]=d=>e.searchForm=d),"menu-name":e.menu_name,"i18n-prefix":"wms.stockAsnInfo",onSureSearch:l.sureSearch},null,8,["modelValue","menu-name","onSureSearch"])]),_:1})]),_:1})]),e.currentRender==="table"?(_(),g("div",{key:0,class:"mt-5",style:y({height:m(b)})},[t($,{ref_key:"xTableStockLocation",ref:h,"column-config":{minWidth:"100px"},data:e.tableData,height:m(I),align:"center"},{empty:n(()=>[Q(S(m(c).global.t("system.page.noData")),1)]),default:n(()=>[t(o,{type:"seq",width:"60"}),t(o,{field:"asn_no",title:a.$t("wms.stockAsnInfo.asn_no")},null,8,["title"]),t(o,{field:"spu_code",title:a.$t("wms.stockAsnInfo.spu_code")},null,8,["title"]),t(o,{field:"spu_name",title:a.$t("wms.stockAsnInfo.spu_name")},null,8,["title"]),t(o,{field:"sku_code",title:a.$t("wms.stockAsnInfo.sku_code")},{default:n(({row:d})=>[u("div",{class:X("text-decoration-none"),onClick:ie=>l.showSkuInfo(d)},S(d.sku_code),9,se)]),_:1},8,["title"]),t(o,{field:"sku_name",title:a.$t("wms.stockAsnInfo.sku_name")},null,8,["title"]),t(o,{field:"goods_owner_name",title:a.$t("wms.stockAsnInfo.goods_owner_name")},null,8,["title"]),t(o,{field:"supplier_name",title:a.$t("wms.stockAsnInfo.supplier_name")},null,8,["title"]),t(o,{field:"asn_qty",title:a.$t("wms.stockAsnInfo.asn_qty")},null,8,["title"]),t(o,{field:"weight",title:a.$t("wms.stockAsnInfo.weight")},null,8,["title"]),t(o,{field:"volume",title:a.$t("wms.stockAsnInfo.volume")},null,8,["title"]),t(o,{field:"actual_qty",title:a.$t("wms.stockAsnInfo.actual_qty")},null,8,["title"]),t(o,{field:"sorted_qty",title:a.$t("wms.stockAsnInfo.sorted_qty")},null,8,["title"]),t(o,{field:"shortage_qty",title:a.$t("wms.stockAsnInfo.shortage_qty")},null,8,["title"]),t(o,{field:"more_qty",title:a.$t("wms.stockAsnInfo.more_qty")},null,8,["title"]),t(o,{field:"damage_qty",title:a.$t("wms.stockAsnInfo.damage_qty")},null,8,["title"])]),_:1},8,["data","height"]),t(F,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":m(E),layouts:m(z),onPageChange:l.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)):(_(),g("div",{key:1,class:"mt-5",style:y({height:m(b)})},[t(Z,{type:"asn","chart-data":e.tableData},null,8,["chart-data"])],4)),t(U,{"show-dialog":e.showDialogShowInfo,form:e.dialogForm,onClose:l.closeDialogShowInfo},null,8,["show-dialog","form","onClose"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),t(j,{ref_key:"ViewDetailDialogRef",ref:v},null,512)],64)}}});const qe=te(le,[["__scopeId","data-v-e685bade"]]);export{qe as default};
