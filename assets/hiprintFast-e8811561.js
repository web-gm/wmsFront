import{u as T}from"./vue-router-1283ad2d.js";import{i as k}from"./i18n-0af8b262.js";import{l as w}from"./printSolution-f5a888b7.js";import{a as B}from"./index-cd6d6b34.js";import{d as M,r as d,c as I,a,x as N,v as $,s,q as i,u as c,y as u,at as _,g as U}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";const D={style:{padding:"5px 15px"}},F={class:"left-top-box"},O=M({__name:"hiprintFast",props:{form:null,tabPage:null},setup(f,{expose:h}){const p=f,{appContext:v}=U(),g=v.config.globalProperties,{hiprint:y}=g,C=T(),e=d({formVisible:!1,hiprintTemplate:{},mode:"",modeList:[],panel:{},printSolutionList:[]}),n=d({initTemplate(){const o=document.getElementById("hiprint-printTemplate");o!==null&&(o.innerHTML=""),e.hiprintTemplate=new y.PrintTemplate({template:e.panel,dataMode:1,history:!1}),e.modeList.length===1?n.handlePrint():e.formVisible=!0},async init(){const o={vue_path:b.value,tab_page:p.tabPage},{data:t}=await w(o);t.isSuccess&&(e.printSolutionList=t.data,e.modeList=e.printSolutionList.map(l=>l.solution_name)),!e.mode&&e.modeList.length===0?(B.$message({type:"error",content:`${k.global.t("system.hiprint.emptyScheme")}`}),n.handleClose()):(e.mode=e.printSolutionList[0].solution_name,n.handleChangeMode())},handleChangeMode(){const o=e.printSolutionList.filter(t=>t.solution_name===e.mode);o.length>0?e.panel=JSON.parse(o[0].config_json):e.panel={},n.initTemplate()},handleClose(){e.formVisible=!1},handleOpen(){n.init()},handlePrint(){e.hiprintTemplate.print(p.form,{},{callback:()=>{}})}}),b=I(()=>{var t;return(t=C.currentRoute.value.name)==null?void 0:t.toString()});return h({method:n}),(o,t)=>{const l=a("v-select"),V=a("v-col"),x=a("v-row"),m=a("v-btn"),L=a("v-card-actions"),P=a("v-card"),S=a("v-dialog");return N(),$(S,{modelValue:e.formVisible,"onUpdate:modelValue":t[1]||(t[1]=r=>e.formVisible=r),width:"260px"},{default:s(()=>[i(P,null,{default:s(()=>[c("div",D,[i(x,null,{default:s(()=>[i(V,{cols:"12"},{default:s(()=>[c("div",F,[i(l,{modelValue:e.mode,"onUpdate:modelValue":[t[0]||(t[0]=r=>e.mode=r),n.handleChangeMode],items:e.modeList,density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])])]),_:1})]),_:1})]),i(L,{class:"justify-end"},{default:s(()=>[i(m,{variant:"text",onClick:n.handleClose},{default:s(()=>[u(_(o.$t("system.page.close")),1)]),_:1},8,["onClick"]),i(m,{color:"primary",variant:"text",onClick:n.handlePrint},{default:s(()=>[u(_(o.$t("system.page.print")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const A=j(O,[["__scopeId","data-v-8065ff70"]]);export{A as h};
