import{i as d,w as v}from"./i18n-0af8b262.js";import{a as q,b as P}from"./style-b9bc59b4.js";import{D as I,a as D,c as $,P as x,b as C}from"./system-93ae242b.js";import{a as T}from"./index-cd6d6b34.js";import{g as z,s as E}from"./common-938b41ea.js";import{c as F}from"./stockManagement-a6372198.js";import A from"./sku-info-b4018d4c.js";import{e as B}from"./exportTable-b0d17537.js";import{B as M}from"./btnGroup-26ff2079.js";import{d as N,b as n,r as _,o as O,c as b,w as V,a as c,x as G,m as H,u as g,q as a,s as r,y as U,at as k,ap as m,aq as j,as as K,O as W}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./index-ae8f073f.js";import"./vue-router-1283ad2d.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./stockAsn-18b92b84.js";import"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";const Y={class:"operateArea"},J=["onClick"],Q=N({__name:"tabStock",setup(R,{expose:y}){const h=n(),t=_({sku_id:0,showDialog:!1,showDialogShowInfo:!1,searchForm:{spu_name:""},activeTab:null,tableData:n([]),tablePage:_({total:0,pageIndex:1,pageSize:I,searchObjects:n([])}),timer:n(null),btnList:[],authorityList:z()}),l=_({closeDialogShowInfo:()=>{t.showDialogShowInfo=!1},showSkuInfo(e){t.sku_id=e.sku_id,t.showDialogShowInfo=!0},sumNum:(e,s)=>{let i=0;return e.forEach(p=>{i+=Number(p[s])}),i},refresh:()=>{l.getStockList()},getStockList:async()=>{const{data:e}=await F(t.tablePage);if(!e.isSuccess){T.$message({type:"error",content:e.errorMessage});return}t.tableData=e.data.rows,t.tablePage.total=e.data.totals},handlePageChange:n(({currentPage:e,pageSize:s})=>{t.tablePage.pageIndex=e,t.tablePage.pageSize=s,l.getStockList()}),exportTable:()=>{const e=h.value;B({table:e,filename:d.global.t("wms.stockManagement.stock"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})},sureSearch:()=>{t.tablePage.searchObjects=E(t.searchForm),l.getStockList()}});O(()=>{t.btnList=[{name:d.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:l.refresh},{name:d.global.t("system.page.export"),icon:"mdi-export-variant",code:"area-export",click:l.exportTable}]});const w=b(()=>q({})),S=b(()=>P({}));return y({getStockList:l.getStockList}),V(()=>t.searchForm,()=>{t.timer&&clearTimeout(t.timer),t.timer=setTimeout(()=>{t.timer=null,l.sureSearch()},D)},{deep:!0}),(e,s)=>{const i=c("v-col"),p=c("v-text-field"),f=c("v-row"),o=c("vxe-column"),L=c("vxe-table");return G(),H(W,null,[g("div",Y,[a(f,{"no-gutters":""},{default:r(()=>[a(i,{cols:"3",class:"col"},{default:r(()=>[a(M,{"authority-list":t.authorityList,"btn-list":t.btnList},null,8,["authority-list","btn-list"])]),_:1}),a(i,{cols:"9"},{default:r(()=>[a(f,{"no-gutters":"",onKeyup:v(l.sureSearch,["enter"])},{default:r(()=>[a(i,{cols:"4"}),a(i,{cols:"4"}),a(i,{cols:"4"},{default:r(()=>[a(p,{modelValue:t.searchForm.spu_name,"onUpdate:modelValue":s[0]||(s[0]=u=>t.searchForm.spu_name=u),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:e.$t("wms.stockList.spu_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),g("div",{class:"mt-5",style:K({height:m(w)})},[a(L,{ref_key:"xTableWarehouse",ref:h,"column-config":{minWidth:"100px"},data:t.tableData,height:m(S),align:"center"},{empty:r(()=>[U(k(m(d).global.t("system.page.noData")),1)]),default:r(()=>[a(o,{type:"seq",width:"60"}),a(o,{type:"checkbox",width:"50"}),a(o,{field:"spu_code",title:e.$t("wms.stockList.spu_code")},null,8,["title"]),a(o,{field:"spu_name",title:e.$t("wms.stockList.spu_name")},null,8,["title"]),a(o,{field:"sku_code",title:e.$t("wms.stockList.sku_code")},{default:r(({row:u})=>[g("div",{class:j("text-decoration-none"),onClick:X=>l.showSkuInfo(u)},k(u.sku_code),9,J)]),_:1},8,["title"]),a(o,{field:"qty",title:e.$t("wms.stockList.qty")},null,8,["title"]),a(o,{field:"qty_available",title:e.$t("wms.stockList.qty_available")},null,8,["title"]),a(o,{field:"qty_locked",title:e.$t("wms.stockList.qty_locked")},null,8,["title"]),a(o,{field:"qty_frozen",title:e.$t("wms.stockList.qty_frozen")},null,8,["title"]),a(o,{field:"qty_asn",title:e.$t("wms.stockList.qty_asn")},null,8,["title"]),a(o,{field:"qty_to_unload",title:e.$t("wms.stockList.qty_to_unload")},null,8,["title"]),a(o,{field:"qty_to_sort",title:e.$t("wms.stockList.qty_to_sort")},null,8,["title"]),a(o,{field:"qty_sorted",title:e.$t("wms.stockList.qty_sorted")},null,8,["title"]),a(o,{field:"shortage_qty",title:e.$t("wms.stockList.shortage_qty")},null,8,["title"])]),_:1},8,["data","height"]),a($,{"current-page":t.tablePage.pageIndex,"page-size":t.tablePage.pageSize,perfect:"",total:t.tablePage.total,"page-sizes":m(x),layouts:m(C),onPageChange:l.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4),a(A,{"show-dialog":t.showDialogShowInfo,sku_id:t.sku_id,onClose:l.closeDialogShowInfo},null,8,["show-dialog","sku_id","onClose"])],64)}}});const bt=Z(Q,[["__scopeId","data-v-5851cb4b"]]);export{bt as default};
