import{a as M}from"./index-cd6d6b34.js";import{a as I}from"./stockManagement-a6372198.js";import{_ as k}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{D as U,a as q,c as O,P as A,b as B}from"./system-93ae242b.js";import{c as j,S as G}from"./style-b9bc59b4.js";import{s as H}from"./common-938b41ea.js";import{i as N}from"./i18n-0af8b262.js";import{d as R,b as u,c as w,r as _,w as S,a as l,x as Y,v as Z,s,q as t,u as $,as as W,ap as r,y as p,at as g,ac as J}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";const Q={class:"dataTable"},X=R({__name:"commodity-select",props:{showDialog:{type:Boolean},sqlTitle:null},emits:["close","sureSelect"],setup(C,{emit:b}){const f=C,h=u(),c=w(()=>f.showDialog),a=_({tableData:[],tablePage:_({total:0,pageIndex:1,pageSize:U,searchObjects:u([])}),searchForm:{location_name:"",warehouse_name:"",spu_name:"",sku_code:""},timer:u(null)}),i=_({handlePageChange:u(({currentPage:e,pageSize:o})=>{a.tablePage.pageIndex=e,a.tablePage.pageSize=o,i.getList()}),sureSearch:()=>{a.tablePage.searchObjects=H(a.searchForm),i.getList()},getList:async()=>{const{data:e}=await I({...a.tablePage,sqlTitle:f.sqlTitle});if(!e.isSuccess){M.$message({type:"error",content:e.errorMessage});return}a.tableData=e.data.rows,a.tablePage.total=e.data.totals},resetForm:()=>{for(const e in a.searchForm){const o=e;a.searchForm[o]=""}a.tablePage.searchObjects=[]},submit:()=>{const e=h.value.getCheckboxRecords();b("sureSelect",e),i.closeDialog()},closeDialog:()=>{b("close")}}),P=w(()=>j({}));return S(()=>c.value,e=>{e&&i.getList()}),S(()=>a.searchForm,()=>{a.timer&&clearTimeout(a.timer),a.timer=setTimeout(()=>{a.timer=null,i.sureSearch()},q)},{deep:!0}),(e,o)=>{const F=l("v-toolbar"),d=l("v-text-field"),V=l("v-form"),v=l("v-col"),n=l("vxe-column"),T=l("vxe-table"),E=l("v-row"),x=l("v-card-text"),y=l("v-btn"),D=l("v-card-actions"),z=l("v-card"),L=l("v-dialog");return Y(),Z(L,{modelValue:r(c),"onUpdate:modelValue":o[4]||(o[4]=m=>J(c)?c.value=m:null),width:"70%",transition:"dialog-top-transition",persistent:!0},{default:s(()=>[t(z,null,{default:s(()=>[t(F,{color:"white",title:`${e.$t("wms.stock.stockSelectModal")}`},null,8,["title"]),t(x,null,{default:s(()=>[t(E,null,{default:s(()=>[t(v,{cols:"3"},{default:s(()=>[$("div",{class:"searchForm",style:W({height:r(P)})},[t(k,{icon:"mdi-refresh",size:"x-small","tooltip-text":e.$t("system.page.reset"),onClick:i.resetForm},null,8,["tooltip-text","onClick"]),t(k,{icon:"mdi-magnify",size:"x-small","tooltip-text":e.$t("system.page.confirm"),onClick:i.sureSearch},null,8,["tooltip-text","onClick"]),t(V,{ref:"formRef",class:"mt-4"},{default:s(()=>[t(d,{modelValue:a.searchForm.warehouse_name,"onUpdate:modelValue":o[0]||(o[0]=m=>a.searchForm.warehouse_name=m),label:e.$t("wms.stock.warehouse"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"]),t(d,{modelValue:a.searchForm.location_name,"onUpdate:modelValue":o[1]||(o[1]=m=>a.searchForm.location_name=m),label:e.$t("wms.stock.location_name"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"]),t(d,{modelValue:a.searchForm.spu_name,"onUpdate:modelValue":o[2]||(o[2]=m=>a.searchForm.spu_name=m),label:e.$t("base.commodityManagement.spu_name"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"]),t(d,{modelValue:a.searchForm.sku_code,"onUpdate:modelValue":o[3]||(o[3]=m=>a.searchForm.sku_code=m),label:e.$t("base.commodityManagement.sku_code"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"])]),_:1},512)],4)]),_:1}),t(v,{cols:"9"},{default:s(()=>[$("div",Q,[t(T,{ref_key:"xTable",ref:h,"column-config":{minWidth:"100px"},data:a.tableData,height:r(G).SELECT_TABLE,align:"center"},{empty:s(()=>[p(g(r(N).global.t("system.page.noData")),1)]),default:s(()=>[t(n,{type:"seq",width:"60"}),t(n,{type:"checkbox",width:"50"}),t(n,{field:"warehouse_name",title:e.$t("wms.stock.warehouse")},null,8,["title"]),t(n,{field:"location_name",title:e.$t("wms.stock.location_name")},null,8,["title"]),t(n,{field:"goods_owner_name",title:e.$t("base.ownerOfCargo.goods_owner_name")},null,8,["title"]),t(n,{field:"spu_code",title:e.$t("base.commodityManagement.spu_code")},null,8,["title"]),t(n,{field:"spu_name",title:e.$t("base.commodityManagement.spu_name")},null,8,["title"]),t(n,{field:"sku_code",title:e.$t("base.commodityManagement.sku_code")},null,8,["title"]),t(n,{field:"sku_name",title:e.$t("base.commodityManagement.sku_name")},null,8,["title"]),t(n,{field:"series_number",title:e.$t("wms.stockLocation.series_number")},null,8,["title"]),t(n,{field:"qty_available",title:e.$t("wms.stock.qty_available")},null,8,["title"])]),_:1},8,["data","height"]),t(O,{"current-page":a.tablePage.pageIndex,"page-size":a.tablePage.pageSize,perfect:"",total:a.tablePage.total,"page-sizes":r(A),layouts:r(B),onPageChange:i.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])])]),_:1})]),_:1})]),_:1}),t(D,{class:"justify-end"},{default:s(()=>[t(y,{variant:"text",onClick:i.closeDialog},{default:s(()=>[p(g(e.$t("system.page.close")),1)]),_:1},8,["onClick"]),t(y,{color:"primary",variant:"text",onClick:i.submit},{default:s(()=>[p(g(e.$t("system.page.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const re=K(X,[["__scopeId","data-v-bea9151a"]]);export{re as c};
