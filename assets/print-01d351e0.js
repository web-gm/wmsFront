import{i as r,w as F}from"./i18n-0af8b262.js";import{a as T,b as E,e as R}from"./style-b9bc59b4.js";import{_ as v}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{g as z,d as B}from"./printSolution-f5a888b7.js";import{a as h}from"./index-cd6d6b34.js";import I from"./add-or-update-print-b2c3131a.js";import{D as V,a as A,c as M,P as O,b as N}from"./system-93ae242b.js";import{g as U,s as j}from"./common-938b41ea.js";import{e as G}from"./exportTable-b0d17537.js";import{B as H}from"./btnGroup-26ff2079.js";import{d as K,b as x,r as w,o as q,c as S,w as J,a as n,x as m,m as u,u as f,q as a,s as i,as as Z,ap as c,y as W,at as g}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./jquery-4c9fd5c5.js";import"./index-ae8f073f.js";const Q={class:"container"},X={class:"operateArea"},ee={key:0},te={key:1},ae={key:0},oe={key:1},se=K({__name:"print",setup(le){const _=x(),e=w({searchForm:{vue_path:"",tab_page:"",solution_name:""},timer:null,tableData:[],tablePage:{total:0,pageIndex:1,pageSize:V},showDialog:!1,dialogForm:{id:0,vue_path:"",tab_page:"",solution_name:"",config_json:"",report_length:0,report_width:0,report_direction:"st",tenant_id:0},btnList:[],authorityList:U(),selectRowData:[]}),s=w({getCheckBoxDisableState:({row:t})=>t.parent_id,selectAllEvent({checked:t}){const o=_.value.getCheckboxRecords();t?e.selectRowData=o:e.selectRowData=[]},selectChangeEvent(){e.selectRowData=_.value.getCheckboxRecords()},sureSearch:()=>{e.tablePage.searchObjects=j(e.searchForm),s.getCompanyList()},getCompanyList:async()=>{const{data:t}=await z(e.tablePage);if(!t.isSuccess){h.$message({type:"error",content:t.errorMessage});return}e.tableData=t.data.rows,e.tablePage.total=t.data.totals},add:()=>{e.dialogForm={id:0,vue_path:"",tab_page:"",solution_name:"",config_json:"",report_length:0,report_width:0,report_direction:""},e.showDialog=!0},closeDialog:()=>{e.showDialog=!1},saveSuccess:()=>{s.refresh(),s.closeDialog()},refresh:()=>{s.getCompanyList()},editRow(t){e.dialogForm=JSON.parse(JSON.stringify(t)),e.showDialog=!0},deleteRow(t){h.$dialog({content:r.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(t.id){const{data:o}=await B(t.id);if(!o.isSuccess){h.$message({type:"error",content:o.errorMessage});return}h.$message({type:"success",content:`${r.global.t("system.page.delete")}${r.global.t("system.tips.success")}`}),s.refresh()}}})},exportTable:()=>{const t=_.value;G({table:t,filename:r.global.t("router.sideBar.print"),columnFilterMethod({column:o}){return!["checkbox"].includes(o==null?void 0:o.type)&&!["operate"].includes(o==null?void 0:o.field)}})},handlePageChange:x(({currentPage:t,pageSize:o})=>{e.tablePage.pageIndex=t,e.tablePage.pageSize=o,s.refresh()})});q(async()=>{await s.getCompanyList(),e.btnList=[{name:r.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:s.add},{name:r.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:s.refresh},{name:r.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:s.exportTable}]});const C=S(()=>T({hasTab:!1})),D=S(()=>E({hasTab:!1}));return J(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,s.sureSearch()},A)},{deep:!0}),(t,o)=>{const d=n("v-col"),b=n("v-text-field"),y=n("v-row"),p=n("vxe-column"),k=n("vxe-table"),P=n("v-card-text"),$=n("v-card");return m(),u("div",Q,[f("div",null,[a($,{class:"mt-5"},{default:i(()=>[a(P,null,{default:i(()=>[f("div",X,[a(y,{"no-gutters":""},{default:i(()=>[a(d,{cols:"12",sm:"4",class:"col"},{default:i(()=>[a(H,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),a(d,{cols:"8",sm:"8"},{default:i(()=>[a(y,{"no-gutters":"",onKeyup:F(s.sureSearch,["enter"])},{default:i(()=>[a(d,{cols:"4"}),a(d,{cols:"4"},{default:i(()=>[a(b,{modelValue:e.searchForm.vue_path,"onUpdate:modelValue":o[0]||(o[0]=l=>e.searchForm.vue_path=l),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("base.printSolution.vue_path"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),a(d,{cols:"4"},{default:i(()=>[a(b,{modelValue:e.searchForm.solution_name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.searchForm.solution_name=l),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("base.printSolution.solution_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),f("div",{class:"mt-5",style:Z({height:c(C)})},[a(k,{ref_key:"xTable",ref:_,data:e.tableData,"column-config":{minWidth:"100px"},height:c(D),align:"center"},{empty:i(()=>[W(g(c(r).global.t("system.page.noData")),1)]),default:i(()=>[a(p,{type:"checkbox",width:"50",fixed:"left"}),a(p,{type:"seq",width:"60"}),a(p,{field:"vue_path",title:t.$t("base.printSolution.vue_path")},{default:i(({row:l})=>[l.parent_id>0?(m(),u("span",ee,g(l.sku_name),1)):(m(),u("span",te,g(t.$t(`router.sideBar.${l.vue_path}`)),1))]),_:1},8,["title"]),a(p,{field:"solution_name",width:"150px",title:t.$t("base.printSolution.solution_name")},{default:i(({row:l})=>[l.parent_id>0?(m(),u("span",ae,g(l.sku_code),1)):(m(),u("span",oe,g(l.solution_name),1))]),_:1},8,["title"]),a(p,{field:"operate",title:t.$t("system.page.operate"),width:"160px",resizable:!1,"show-overflow":""},{default:i(({row:l})=>[f("div",null,[a(v,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":t.$t("system.page.edit"),onClick:L=>s.editRow(l)},null,8,["tooltip-text","onClick"]),a(v,{flat:!0,icon:"mdi-delete-outline","tooltip-text":t.$t("system.page.delete"),"icon-color":e.authorityList.includes("delete")?c(R):"",disabled:!e.authorityList.includes("delete"),onClick:L=>s.deleteRow(l)},null,8,["tooltip-text","icon-color","disabled","onClick"])])]),_:1},8,["title"])]),_:1},8,["data","height"]),a(M,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":c(O),layouts:c(N),onPageChange:s.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)]),_:1})]),_:1})]),a(I,{"show-dialog":e.showDialog,form:e.dialogForm,onClose:s.closeDialog,onSaveSuccess:s.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"])])}}});const Ce=Y(se,[["__scopeId","data-v-aa393920"]]);export{Ce as default};
