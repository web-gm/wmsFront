import{i,w as $}from"./i18n-0af8b262.js";import{a as I,b as P,e as L}from"./style-b9bc59b4.js";import{_}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{g as T,d as k}from"./ownerOfCargo-a67b46ea.js";import{a as g}from"./index-cd6d6b34.js";import F from"./add-or-update-owner-of-cargo-d0cf2bd5.js";import E from"./import-table-76607b37.js";import{g as z,s as M}from"./common-938b41ea.js";import{D as B,a as A,c as H,P as N,b as V}from"./system-93ae242b.js";import{e as U}from"./exportTable-b0d17537.js";import{B as G}from"./btnGroup-26ff2079.js";import{d as R,b as h,r as b,o as K,c as w,w as j,a as n,x as q,m as J,u as p,q as t,s as r,as as Z,ap as c,y as W,at as Y}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./formRule-3feb276f.js";import"./index-ae8f073f.js";import"./formatSystem-1203ad16.js";const X={class:"container"},ee={class:"operateArea"},te=R({__name:"ownerOfCargo",setup(ae){const u=h(),e=b({searchForm:{goods_owner_name:""},showDialogImport:!1,tableData:[],showDialog:!1,dialogForm:{id:0,goods_owner_name:"",city:"",address:"",contact_tel:"",manager:""},tablePage:{total:0,pageIndex:1,pageSize:B},timer:null,btnList:[],authorityList:z()}),o=b({handlePageChange:h(({currentPage:a,pageSize:s})=>{e.tablePage.pageIndex=a,e.tablePage.pageSize=s,o.refresh()}),openDialogImport:()=>{e.showDialogImport=!0},closeDialogImport:()=>{e.showDialogImport=!1},saveSuccessImport:()=>{o.refresh(),o.closeDialogImport()},sureSearch:()=>{e.tablePage.searchObjects=M(e.searchForm),o.getOwnerOfCargoList()},getOwnerOfCargoList:async()=>{const{data:a}=await T(e.tablePage);if(!a.isSuccess){g.$message({type:"error",content:a.errorMessage});return}e.tableData=a.data.rows,e.tablePage.total=a.data.totals},add:()=>{e.dialogForm={id:0,goods_owner_name:"",city:"",address:"",contact_tel:"",manager:""},e.showDialog=!0},closeDialog:()=>{e.showDialog=!1},saveSuccess:()=>{o.refresh(),o.closeDialog()},refresh:()=>{o.getOwnerOfCargoList()},editRow(a){e.dialogForm=JSON.parse(JSON.stringify(a)),e.showDialog=!0},deleteRow(a){g.$dialog({content:i.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(a.id){const{data:s}=await k(a.id);if(!s.isSuccess){g.$message({type:"error",content:s.errorMessage});return}g.$message({type:"success",content:`${i.global.t("system.page.delete")}${i.global.t("system.tips.success")}`}),o.refresh()}}})},exportTable:()=>{const a=u.value;U({table:a,filename:i.global.t("router.sideBar.ownerOfCargo"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})}});K(async()=>{e.btnList=[{name:i.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:o.add},{name:i.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:o.refresh},{name:i.global.t("system.page.import"),icon:"mdi-database-import-outline",code:"import",click:o.openDialogImport},{name:i.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:o.exportTable}],await o.getOwnerOfCargoList()});const y=w(()=>I({hasTab:!1})),v=w(()=>P({hasTab:!1}));return j(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,o.sureSearch()},A)},{deep:!0}),(a,s)=>{const d=n("v-col"),C=n("v-text-field"),f=n("v-row"),l=n("vxe-column"),O=n("vxe-table"),D=n("v-card-text"),S=n("v-card");return q(),J("div",X,[p("div",null,[t(S,{class:"mt-5"},{default:r(()=>[t(D,null,{default:r(()=>[p("div",ee,[t(f,{"no-gutters":""},{default:r(()=>[t(d,{cols:"12",sm:"4",class:"col"},{default:r(()=>[t(G,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),t(d,{cols:"12",sm:"8"},{default:r(()=>[t(f,{"no-gutters":"",onKeyup:$(o.sureSearch,["enter"])},{default:r(()=>[t(d,{cols:"4"}),t(d,{cols:"4"}),t(d,{cols:"4"},{default:r(()=>[t(C,{modelValue:e.searchForm.goods_owner_name,"onUpdate:modelValue":s[0]||(s[0]=m=>e.searchForm.goods_owner_name=m),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:a.$t("base.ownerOfCargo.goods_owner_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),p("div",{class:"mt-5",style:Z({height:c(y)})},[t(O,{ref_key:"xTable",ref:u,"column-config":{minWidth:"100px"},data:e.tableData,height:c(v),align:"center"},{empty:r(()=>[W(Y(c(i).global.t("system.page.noData")),1)]),default:r(()=>[t(l,{type:"seq",width:"60"}),t(l,{field:"goods_owner_name",title:a.$t("base.ownerOfCargo.goods_owner_name")},null,8,["title"]),t(l,{field:"city",title:a.$t("base.ownerOfCargo.city")},null,8,["title"]),t(l,{field:"address",title:a.$t("base.ownerOfCargo.address")},null,8,["title"]),t(l,{field:"contact_tel",title:a.$t("base.ownerOfCargo.contact_tel")},null,8,["title"]),t(l,{field:"manager",title:a.$t("base.ownerOfCargo.manager")},null,8,["title"]),t(l,{field:"creator",title:a.$t("base.ownerOfCargo.creator")},null,8,["title"]),t(l,{field:"create_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:a.$t("base.ownerOfCargo.create_time")},null,8,["title"]),t(l,{field:"operate",title:a.$t("system.page.operate"),width:"160",resizable:!1,"show-overflow":""},{default:r(({row:m})=>[t(_,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":a.$t("system.page.edit"),disabled:!e.authorityList.includes("save"),onClick:x=>o.editRow(m)},null,8,["tooltip-text","disabled","onClick"]),t(_,{flat:!0,icon:"mdi-delete-outline","tooltip-text":a.$t("system.page.delete"),"icon-color":e.authorityList.includes("delete")?c(L):"",disabled:!e.authorityList.includes("delete"),onClick:x=>o.deleteRow(m)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),t(H,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":c(N),layouts:c(V),onPageChange:o.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)]),_:1})]),_:1})]),t(F,{"show-dialog":e.showDialog,form:e.dialogForm,onClose:o.closeDialog,onSaveSuccess:o.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"]),t(E,{"show-dialog":e.showDialogImport,onClose:o.closeDialogImport,onSaveSuccess:o.saveSuccessImport},null,8,["show-dialog","onClose","onSaveSuccess"])])}}});const Oe=Q(te,[["__scopeId","data-v-ecd4e239"]]);export{Oe as default};
