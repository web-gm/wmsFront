import{a as $,b as D,e as k}from"./style-b9bc59b4.js";import{_ as f}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{g as L,d as T,a as B}from"./add-or-update-company-46e8e739.js";import{a as c}from"./index-cd6d6b34.js";import{i}from"./i18n-0af8b262.js";import{e as M}from"./exportTable-b0d17537.js";import{B as F}from"./btnGroup-26ff2079.js";import{g as N}from"./common-938b41ea.js";import{d as H,b as R,r as y,o as A,c as _,a as r,x as O,m as V,u as m,q as t,s as n,as as q,ap as d,y as z,at as J}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./formRule-3feb276f.js";import"./index-ae8f073f.js";const G={class:"container"},I={class:"operateArea"},P=H({__name:"companySetting",setup(U){const p=R(),a=y({tableData:[],showDialog:!1,dialogForm:{id:0,company_name:"",city:"",address:"",manager:"",contact_tel:""},btnList:[],authorityList:N()}),o=y({sureSearch:()=>{},getCompanyList:async()=>{const{data:e}=await L();if(!e.isSuccess){c.$message({type:"error",content:e.errorMessage});return}a.tableData=e.data},add:()=>{a.dialogForm={id:0,company_name:"",city:"",address:"",manager:"",contact_tel:""},a.showDialog=!0},closeDialog:()=>{a.showDialog=!1},saveSuccess:()=>{o.refresh(),o.closeDialog()},refresh:()=>{o.getCompanyList()},editRow(e){a.dialogForm=JSON.parse(JSON.stringify(e)),a.showDialog=!0},deleteRow(e){c.$dialog({content:i.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(e.id){const{data:s}=await T(e.id);if(!s.isSuccess){c.$message({type:"error",content:s.errorMessage});return}c.$message({type:"success",content:`${i.global.t("system.page.delete")}${i.global.t("system.tips.success")}`}),o.refresh()}}})},exportTable:()=>{const e=p.value;M({table:e,filename:i.global.t("router.sideBar.companySetting"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})}});A(async()=>{await o.getCompanyList(),a.btnList=[{name:i.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:o.add},{name:i.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:o.refresh},{name:i.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:o.exportTable}]});const h=_(()=>$({hasTab:!1})),b=_(()=>D({hasTab:!1,hasPager:!1}));return(e,s)=>{const g=r("v-col"),v=r("v-row"),l=r("vxe-column"),S=r("vxe-table"),w=r("v-card-text"),x=r("v-card");return O(),V("div",G,[m("div",null,[t(x,{class:"mt-5"},{default:n(()=>[t(w,null,{default:n(()=>[m("div",I,[t(v,{"no-gutters":""},{default:n(()=>[t(g,{cols:"12",sm:"4",class:"col"},{default:n(()=>[t(F,{"authority-list":a.authorityList,"btn-list":a.btnList},null,8,["authority-list","btn-list"])]),_:1}),t(g,{cols:"12",sm:"8"})]),_:1})]),m("div",{class:"mt-5",style:q({height:d(h)})},[t(S,{ref_key:"xTable",ref:p,data:a.tableData,height:d(b),align:"center"},{empty:n(()=>[z(J(d(i).global.t("system.page.noData")),1)]),default:n(()=>[t(l,{type:"seq",width:"60"}),t(l,{field:"company_name",title:e.$t("base.companySetting.company_name")},null,8,["title"]),t(l,{field:"city",title:e.$t("base.companySetting.city")},null,8,["title"]),t(l,{field:"address",title:e.$t("base.companySetting.address")},null,8,["title"]),t(l,{field:"manager",title:e.$t("base.companySetting.manager")},null,8,["title"]),t(l,{field:"contact_tel",title:e.$t("base.companySetting.contact_tel")},null,8,["title"]),t(l,{field:"operate",title:e.$t("system.page.operate"),width:"160",resizable:!1,"show-overflow":""},{default:n(({row:u})=>[t(f,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":e.$t("system.page.edit"),disabled:!a.authorityList.includes("save"),onClick:C=>o.editRow(u)},null,8,["tooltip-text","disabled","onClick"]),t(f,{flat:!0,icon:"mdi-delete-outline","tooltip-text":e.$t("system.page.delete"),"icon-color":a.authorityList.includes("delete")?d(k):"",disabled:!a.authorityList.includes("delete"),onClick:C=>o.deleteRow(u)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"])],4)]),_:1})]),_:1})]),t(B,{"show-dialog":a.showDialog,form:a.dialogForm,onClose:o.closeDialog,onSaveSuccess:o.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"])])}}});const ce=E(P,[["__scopeId","data-v-ea620cf0"]]);export{ce as default};
