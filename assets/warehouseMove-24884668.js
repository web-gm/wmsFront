import{i as n,w as L}from"./i18n-0af8b262.js";import{a as B,b as E,e as j}from"./style-b9bc59b4.js";import{M as h}from"./WarehouseMove-eb0037f6.js";import{D as A,a as F,c as O,P as U,b as z}from"./system-93ae242b.js";import{a as c}from"./index-cd6d6b34.js";import{g as I,a as V,d as H,c as N,_ as q}from"./add-or-update-move.vue_vue_type_script_setup_true_lang-af30c95a.js";import{P as R}from"./warehouseWorking-497fd91f.js";import{g as G,s as J}from"./common-938b41ea.js";import{b as K}from"./formatWarehouseWorking-dc5b5102.js";import{_ as f}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{e as Z}from"./exportTable-b0d17537.js";import{B as Y}from"./btnGroup-26ff2079.js";import{d as Q,b as g,r as w,n as y,k as X,o as ee,c as M,w as te,a as d,x as oe,m as ae,u as p,q as t,s as r,as as se,ap as m,y as ie,at as k}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./commodity-select-5da8c47a.js";import"./stockManagement-a6372198.js";import"./location-select-a2f98b65.js";import"./warehouseSetting-835f9e1c.js";import"./formatSystem-1203ad16.js";import"./index-ae8f073f.js";import"./formatWarehouse-aebb7b18.js";import"./Warehouse-56a6b193.js";import"./custom-qrcode-7ab7b0a5.js";import"./formRule-3feb276f.js";import"./WarehouseAdjust-937657c2.js";const le={class:"container"},ne={class:"operateArea"},de=Q({__name:"warehouseMove",setup(ce){const v=g(),o=w({showDialog:!1,processType:R,timer:g(null),activeTab:null,searchForm:{job_code:""},tableData:g([]),dialogForm:{id:0,job_code:"",move_status:h.UNADJUST,sku_id:0,orig_goods_location_id:0,dest_googs_location_id:0,qty:0,goods_owner_id:0,handler:"",handle_time:"",orig_goods_warehouse:"",orig_goods_location_name:"",dest_googs_warehouse:"",dest_googs_location_name:"",spu_code:"",spu_name:"",sku_code:"",sku_name:"",series_number:"",creator:"",create_time:""},tablePage:w({total:0,pageIndex:1,pageSize:A,searchObjects:g([])}),btnList:[],authorityList:G()}),a=w({add:()=>{o.dialogForm={id:0,job_code:"",move_status:h.UNADJUST,sku_id:0,orig_goods_location_id:0,dest_googs_location_id:0,qty:0,goods_owner_id:0,handler:"",handle_time:"",orig_goods_warehouse:"",orig_goods_location_name:"",dest_googs_warehouse:"",dest_googs_location_name:"",spu_code:"",spu_name:"",sku_code:"",sku_name:"",series_number:"",creator:"",create_time:""},y(()=>{o.showDialog=!0})},saveSuccess:()=>{a.refresh(),a.closeDialog()},refresh:()=>{a.getStockProcessList()},closeDialog:()=>{o.showDialog=!1},getStockProcessList:async()=>{const{data:e}=await I(o.tablePage);if(!e.isSuccess){c.$message({type:"error",content:e.errorMessage});return}o.tableData=e.data.rows,o.tablePage.total=e.data.totals},viewRow:async e=>{await a.getOne(e.id),y(()=>{o.showDialog=!0})},getOne:async e=>{const{data:s}=await V(e);if(!s.isSuccess){c.$message({type:"error",content:s.errorMessage});return}o.dialogForm=s.data},deleteRow(e){c.$dialog({content:n.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(e.id){const{data:s}=await H(e.id);if(!s.isSuccess){c.$message({type:"error",content:s.errorMessage});return}c.$message({type:"success",content:`${n.global.t("system.page.delete")}${n.global.t("system.tips.success")}`}),a.refresh()}}})},handlePageChange:g(({currentPage:e,pageSize:s})=>{o.tablePage.pageIndex=e,o.tablePage.pageSize=s,a.refresh()}),exportTable:()=>{const e=v.value;Z({table:e,filename:n.global.t("router.sideBar.warehouseMove"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})},sureSearch:()=>{o.tablePage.searchObjects=J(o.searchForm),a.refresh()},confirmMoveBtnDisabled:e=>e.move_status===h.ADJUSTED,confirmMove:async e=>{c.$dialog({content:n.global.t("wms.warehouseWorking.warehouseMove.beforeConfirmMove"),handleConfirm:async()=>{if(e.id){const{data:s}=await N(e.id);if(!s.isSuccess){c.$message({type:"error",content:s.errorMessage});return}c.$message({type:"success",content:`${n.global.t("wms.warehouseWorking.warehouseMove.confirmMove")}${n.global.t("system.tips.success")}`}),a.refresh()}}})}});X(()=>{a.refresh()}),ee(()=>{o.btnList=[{name:n.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:a.add},{name:n.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:a.refresh},{name:n.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:a.exportTable}]});const $=M(()=>B({hasTab:!1})),S=M(()=>E({hasTab:!1}));return te(()=>o.searchForm,()=>{o.timer&&clearTimeout(o.timer),o.timer=setTimeout(()=>{o.timer=null,a.sureSearch()},F)},{deep:!0}),(e,s)=>{const u=d("v-col"),x=d("v-text-field"),b=d("v-row"),i=d("vxe-column"),D=d("vxe-table"),C=d("v-window-item"),P=d("v-window"),T=d("v-card-text"),W=d("v-card");return oe(),ae("div",le,[p("div",null,[t(W,{class:"mt-5"},{default:r(()=>[t(T,null,{default:r(()=>[t(P,{modelValue:o.activeTab,"onUpdate:modelValue":s[1]||(s[1]=l=>o.activeTab=l)},{default:r(()=>[t(C,null,{default:r(()=>[p("div",ne,[t(b,{"no-gutters":""},{default:r(()=>[t(u,{cols:"3",class:"col"},{default:r(()=>[t(Y,{"authority-list":o.authorityList,"btn-list":o.btnList},null,8,["authority-list","btn-list"])]),_:1}),t(u,{cols:"9"},{default:r(()=>[t(b,{"no-gutters":"",onKeyup:L(a.sureSearch,["enter"])},{default:r(()=>[t(u,{cols:"4"}),t(u,{cols:"4"}),t(u,{cols:"4"},{default:r(()=>[t(x,{modelValue:o.searchForm.job_code,"onUpdate:modelValue":s[0]||(s[0]=l=>o.searchForm.job_code=l),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:e.$t("wms.warehouseWorking.warehouseMove.job_code"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),p("div",{class:"mt-5",style:se({height:m($)})},[t(D,{ref_key:"xTable",ref:v,"column-config":{minWidth:"100px"},data:o.tableData,height:m(S),align:"center"},{empty:r(()=>[ie(k(m(n).global.t("system.page.noData")),1)]),default:r(()=>[t(i,{type:"seq",width:"60"}),t(i,{type:"checkbox",width:"50"}),t(i,{field:"job_code",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.job_code")},null,8,["title"]),t(i,{field:"move_status",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.move_status")},{default:r(({row:l,column:_})=>[p("span",null,k(m(K)(l[_.property])),1)]),_:1},8,["title"]),t(i,{field:"spu_code",width:"150px",title:e.$t("base.commodityManagement.spu_code")},null,8,["title"]),t(i,{field:"spu_name",width:"150px",title:e.$t("base.commodityManagement.spu_name")},null,8,["title"]),t(i,{field:"sku_code",width:"150px",title:e.$t("base.commodityManagement.sku_code")},null,8,["title"]),t(i,{field:"sku_name",width:"150px",title:e.$t("base.commodityManagement.sku_name")},null,8,["title"]),t(i,{field:"qty",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.qty")},null,8,["title"]),t(i,{field:"orig_goods_warehouse",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.orig_goods_warehouse")},null,8,["title"]),t(i,{field:"orig_goods_location_name",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.orig_goods_location_name")},null,8,["title"]),t(i,{field:"dest_googs_warehouse",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.dest_googs_warehouse")},null,8,["title"]),t(i,{field:"dest_googs_location_name",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.dest_googs_location_name")},null,8,["title"]),t(i,{field:"creator",title:e.$t("wms.warehouseWorking.warehouseMove.creator")},null,8,["title"]),t(i,{field:"create_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:e.$t("wms.warehouseWorking.warehouseMove.create_time")},null,8,["title"]),t(i,{field:"handler",width:"150px",title:e.$t("wms.warehouseWorking.warehouseMove.handler")},null,8,["title"]),t(i,{field:"handle_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:e.$t("wms.warehouseWorking.warehouseMove.handle_time")},null,8,["title"]),t(i,{field:"operate",title:e.$t("system.page.operate"),width:"250",resizable:!1,"show-overflow":""},{default:r(({row:l})=>[t(f,{flat:!0,icon:"mdi-eye-outline","tooltip-text":e.$t("system.page.view"),onClick:_=>a.viewRow(l)},null,8,["tooltip-text","onClick"]),t(f,{flat:!0,icon:"mdi-book-open-outline","tooltip-text":e.$t("wms.warehouseWorking.warehouseMove.confirmMove"),disabled:!o.authorityList.includes("confirm")||a.confirmMoveBtnDisabled(l),onClick:_=>a.confirmMove(l)},null,8,["tooltip-text","disabled","onClick"]),t(f,{flat:!0,icon:"mdi-delete-outline","tooltip-text":e.$t("system.page.delete"),"icon-color":!o.authorityList.includes("delete")||a.confirmMoveBtnDisabled(l)?"":m(j),disabled:!o.authorityList.includes("delete")||a.confirmMoveBtnDisabled(l),onClick:_=>a.deleteRow(l)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),t(O,{"current-page":o.tablePage.pageIndex,"page-size":o.tablePage.pageSize,perfect:"",total:o.tablePage.total,"page-sizes":m(U),layouts:m(z),onPageChange:a.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(q,{"show-dialog":o.showDialog,form:o.dialogForm,"process-type":o.processType,onClose:a.closeDialog,onSaveSuccess:a.saveSuccess},null,8,["show-dialog","form","process-type","onClose","onSaveSuccess"])])])}}});const ze=re(de,[["__scopeId","data-v-4e56fca9"]]);export{ze as default};
