import{i as d,w as $}from"./i18n-0af8b262.js";import{a as j,b as C}from"./style-b9bc59b4.js";import{D as L,a as M,c as O,P as W,b as B}from"./system-93ae242b.js";import{F as p,a as V}from"./warehouseWorking-497fd91f.js";import{a as b}from"./index-cd6d6b34.js";import{a as A}from"./formatWarehouseWorking-dc5b5102.js";import{g as I,a as U,b as H}from"./add-or-update-freeze-c7bf4838.js";import{g as R,s as Z}from"./common-938b41ea.js";import{_ as N}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{e as G}from"./exportTable-b0d17537.js";import{B as J}from"./btnGroup-26ff2079.js";import{d as K,b as u,r as h,n as y,k as q,o as Y,c as v,w as Q,a as l,x as X,m as ee,u as _,q as t,s as i,as as te,ap as c,y as ae,at as k}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./WarehouseMove-eb0037f6.js";import"./WarehouseAdjust-937657c2.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./commodity-select-5da8c47a.js";import"./stockManagement-a6372198.js";import"./index-ae8f073f.js";const se={class:"container"},re={class:"operateArea"},ie=K({__name:"warehouseFreeze",setup(le){const g=u(),e=h({showDialog:!1,freezeType:p,timer:u(null),activeTab:null,searchForm:{job_code:""},tableData:u([]),dialogForm:{id:0,job_code:"",job_type:p,sku_id:0,goods_owner_id:0,goods_location_id:0,handler:"",handle_time:"",last_update_time:"",tenant_id:0,warehouse_name:"",location_name:"",spu_code:"",spu_name:"",sku_code:"",series_number:"",creator:"",create_time:""},tablePage:h({total:0,pageIndex:1,pageSize:L,searchObjects:u([])}),btnList:[],authorityList:R()}),o=h({add:a=>{e.freezeType=a,e.dialogForm={id:0,job_code:"",job_type:p,sku_id:0,goods_owner_id:0,goods_location_id:0,handler:"",handle_time:"",last_update_time:"",tenant_id:0,warehouse_name:"",location_name:"",spu_code:"",spu_name:"",sku_code:"",series_number:"",creator:"",create_time:""},y(()=>{e.showDialog=!0})},saveSuccess:()=>{o.refresh(),o.closeDialog()},refresh:()=>{o.getStockProcessList()},closeDialog:()=>{e.showDialog=!1},getStockProcessList:async()=>{const{data:a}=await I(e.tablePage);if(!a.isSuccess){b.$message({type:"error",content:a.errorMessage});return}e.tableData=a.data.rows,e.tablePage.total=a.data.totals},viewRow:async a=>{await o.getOne(a.id),y(()=>{e.showDialog=!0})},getOne:async a=>{const{data:s}=await U(a);if(!s.isSuccess){b.$message({type:"error",content:s.errorMessage});return}e.dialogForm=s.data},handlePageChange:u(({currentPage:a,pageSize:s})=>{e.tablePage.pageIndex=a,e.tablePage.pageSize=s,o.refresh()}),exportTable:()=>{const a=g.value;G({table:a,filename:d.global.t("router.sideBar.warehouseFreeze"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})},sureSearch:()=>{e.tablePage.searchObjects=Z(e.searchForm),o.refresh()}});q(()=>{o.refresh()}),Y(()=>{e.btnList=[{name:d.global.t("wms.warehouseWorking.warehouseFreeze.freeze"),icon:"mdi-lock-open-outline",code:"freeze",click:()=>{o.add(p)}},{name:d.global.t("wms.warehouseWorking.warehouseFreeze.unfreeze"),icon:"mdi-lock-open-variant-outline",code:"unfreeze",click:()=>{o.add(V)}},{name:d.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:o.refresh},{name:d.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:o.exportTable}]});const z=v(()=>j({hasTab:!1})),F=v(()=>C({hasTab:!1}));return Q(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,o.sureSearch()},M)},{deep:!0}),(a,s)=>{const m=l("v-col"),x=l("v-text-field"),f=l("v-row"),r=l("vxe-column"),S=l("vxe-table"),E=l("v-window-item"),T=l("v-window"),P=l("v-card-text"),D=l("v-card");return X(),ee("div",se,[_("div",null,[t(D,{class:"mt-5"},{default:i(()=>[t(P,null,{default:i(()=>[t(T,{modelValue:e.activeTab,"onUpdate:modelValue":s[1]||(s[1]=n=>e.activeTab=n)},{default:i(()=>[t(E,null,{default:i(()=>[_("div",re,[t(f,{"no-gutters":""},{default:i(()=>[t(m,{cols:"3",class:"col"},{default:i(()=>[t(J,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),t(m,{cols:"9"},{default:i(()=>[t(f,{"no-gutters":"",onKeyup:$(o.sureSearch,["enter"])},{default:i(()=>[t(m,{cols:"4"}),t(m,{cols:"4"}),t(m,{cols:"4"},{default:i(()=>[t(x,{modelValue:e.searchForm.job_code,"onUpdate:modelValue":s[0]||(s[0]=n=>e.searchForm.job_code=n),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:a.$t("wms.warehouseWorking.warehouseFreeze.job_code"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),_("div",{class:"mt-5",style:te({height:c(z)})},[t(S,{ref_key:"xTable",ref:g,"column-config":{minWidth:"100px"},data:e.tableData,height:c(F),align:"center"},{empty:i(()=>[ae(k(c(d).global.t("system.page.noData")),1)]),default:i(()=>[t(r,{type:"seq",width:"60"}),t(r,{type:"checkbox",width:"50"}),t(r,{field:"job_code",width:"150px",title:a.$t("wms.warehouseWorking.warehouseFreeze.job_code")},null,8,["title"]),t(r,{field:"job_type",width:"150px",title:a.$t("wms.warehouseWorking.warehouseFreeze.job_type")},{default:i(({row:n,column:w})=>[_("span",null,k(c(A)(n[w.property])),1)]),_:1},8,["title"]),t(r,{field:"warehouse_name",width:"150px",title:a.$t("wms.warehouseWorking.warehouseFreeze.warehouse")},null,8,["title"]),t(r,{field:"location_name",width:"150px",title:a.$t("wms.warehouseWorking.warehouseFreeze.location_name")},null,8,["title"]),t(r,{field:"spu_code",width:"150px",title:a.$t("base.commodityManagement.spu_code")},null,8,["title"]),t(r,{field:"spu_name",width:"150px",title:a.$t("base.commodityManagement.spu_name")},null,8,["title"]),t(r,{field:"sku_code",width:"150px",title:a.$t("base.commodityManagement.sku_code")},null,8,["title"]),t(r,{field:"series_number",width:"150px",title:a.$t("wms.stockLocation.series_number")},null,8,["title"]),t(r,{field:"handler",width:"150px",title:a.$t("wms.warehouseWorking.warehouseFreeze.handler")},null,8,["title"]),t(r,{field:"handle_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:a.$t("wms.warehouseWorking.warehouseFreeze.handle_time")},null,8,["title"]),t(r,{field:"operate",title:a.$t("system.page.operate"),width:"100",resizable:!1,"show-overflow":""},{default:i(({row:n})=>[t(N,{flat:!0,icon:"mdi-eye-outline","tooltip-text":a.$t("system.page.view"),onClick:w=>o.viewRow(n)},null,8,["tooltip-text","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),t(O,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":c(W),layouts:c(B),onPageChange:o.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(H,{"show-dialog":e.showDialog,form:e.dialogForm,"freeze-type":e.freezeType,onClose:o.closeDialog,onSaveSuccess:o.saveSuccess},null,8,["show-dialog","form","freeze-type","onClose","onSaveSuccess"])])])}}});const De=oe(ie,[["__scopeId","data-v-e6b7b1f5"]]);export{De as default};
