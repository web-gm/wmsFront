import{i as d,w as k}from"./i18n-0af8b262.js";import{a as P,b as B}from"./style-b9bc59b4.js";import{D as C,a as x,c as I,P as F,b as S}from"./system-93ae242b.js";import{a as g}from"./index-cd6d6b34.js";import{t as V,x as E}from"./deliveryManagement-7eebd823.js";import{_ as L}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{G as f}from"./commodityManagement-a1debff9.js";import{g as z,s as A}from"./common-938b41ea.js";import{_ as U}from"./search-delivered-detail.vue_vue_type_script_setup_true_lang-20446111.js";import{e as q}from"./exportTable-b0d17537.js";import{B as G}from"./btnGroup-26ff2079.js";import{d as O,b as p,r as b,o as N,c as w,w as j,a as h,x as H,m as K,u,q as e,s as n,y as R,at as v,ap as m,as as W,O as Z}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";const J={class:"operateArea"},Q={style:{width:"100%",display:"flex","justify-content":"center"}},X=O({__name:"tabToBeDelivered",setup(ee,{expose:D}){const _=p(),a=b({showDeliveredDetailID:0,showDeliveredDetail:!1,dialogForm:{id:0},searchForm:{dispatch_no:"",customer_name:"",spu_name:""},timer:p(null),activeTab:null,tableData:p([]),tablePage:p({total:0,pageIndex:1,pageSize:C,searchObjects:[]}),btnList:[],authorityList:z()}),o=b({closeDeliveredDetail:()=>{a.showDeliveredDetail=!1},viewRow:t=>{a.showDeliveredDetailID=t.id,a.showDeliveredDetail=!0},handleDeliver:async()=>{const l=_.value.getCheckboxRecords();if(l.length>0){const c=l.map(r=>({id:r.id,dispatch_no:r.dispatch_no,dispatch_status:r.dispatch_status,picked_qty:r.picked_qty}));g.$dialog({content:`${d.global.t("wms.deliveryManagement.irreversible")}, ${d.global.t("wms.deliveryManagement.confirmDelivery")}?`,handleConfirm:async()=>{const{data:r}=await V(c);if(!r.isSuccess){g.$message({type:"error",content:r.errorMessage});return}g.$message({type:"success",content:r.data}),o.refresh()}})}else g.$message({type:"error",content:`${d.global.t("base.userManagement.checkboxIsNull")}`})},refresh:()=>{o.getToBeDelivery()},getToBeDelivery:async()=>{const{data:t}=await E(a.tablePage);if(!t.isSuccess){g.$message({type:"error",content:t.errorMessage});return}a.tableData=t.data.rows,a.tablePage.total=t.data.totals},handlePageChange:p(({currentPage:t,pageSize:l})=>{a.tablePage.pageIndex=t,a.tablePage.pageSize=l,o.getToBeDelivery()}),exportTable:()=>{const t=_.value;q({table:t,filename:d.global.t("wms.deliveryManagement.toBeDelivered"),columnFilterMethod({column:l}){return!["checkbox"].includes(l==null?void 0:l.type)&&!["operate"].includes(l==null?void 0:l.field)}})},sureSearch:()=>{a.tablePage.searchObjects=A(a.searchForm),o.getToBeDelivery()}});N(()=>{a.btnList=[{name:d.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:o.refresh},{name:d.global.t("system.page.export"),icon:"mdi-export-variant",code:"delivered-export",click:o.exportTable},{name:d.global.t("wms.deliveryManagement.delivery"),icon:"mdi-cube-send",code:"delivered-delivery",click:o.handleDeliver}]});const $=w(()=>P({})),M=w(()=>B({}));return j(()=>a.searchForm,()=>{a.timer&&clearTimeout(a.timer),a.timer=setTimeout(()=>{a.timer=null,o.sureSearch()},x)},{deep:!0}),D({getToBeDelivery:o.getToBeDelivery}),(t,l)=>{const c=h("v-col"),r=h("v-text-field"),y=h("v-row"),i=h("vxe-column"),T=h("vxe-table");return H(),K(Z,null,[u("div",J,[e(y,{"no-gutters":""},{default:n(()=>[e(c,{cols:"3",class:"col"},{default:n(()=>[e(G,{"authority-list":a.authorityList,"btn-list":a.btnList},null,8,["authority-list","btn-list"])]),_:1}),e(c,{cols:"9"},{default:n(()=>[e(y,{"no-gutters":"",onKeyup:k(o.sureSearch,["enter"])},{default:n(()=>[e(c,{cols:"4"},{default:n(()=>[e(r,{modelValue:a.searchForm.dispatch_no,"onUpdate:modelValue":l[0]||(l[0]=s=>a.searchForm.dispatch_no=s),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.deliveryManagement.dispatch_no"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),e(c,{cols:"4"},{default:n(()=>[e(r,{modelValue:a.searchForm.customer_name,"onUpdate:modelValue":l[1]||(l[1]=s=>a.searchForm.customer_name=s),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.deliveryManagement.customer_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),e(c,{cols:"4"},{default:n(()=>[e(r,{modelValue:a.searchForm.spu_name,"onUpdate:modelValue":l[2]||(l[2]=s=>a.searchForm.spu_name=s),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.deliveryManagement.spu_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),u("div",{class:"mt-5",style:W({height:m($)})},[e(T,{ref_key:"xTable",ref:_,"column-config":{minWidth:"100px"},data:a.tableData,height:m(M),align:"center"},{empty:n(()=>[R(v(m(d).global.t("system.page.noData")),1)]),default:n(()=>[e(i,{type:"seq",width:"60"}),e(i,{type:"checkbox",width:"50"}),e(i,{field:"dispatch_no",title:t.$t("wms.deliveryManagement.dispatch_no")},null,8,["title"]),e(i,{field:"spu_code",title:t.$t("wms.deliveryManagement.spu_code")},null,8,["title"]),e(i,{field:"spu_description",width:"200px",title:t.$t("wms.deliveryManagement.spu_description")},null,8,["title"]),e(i,{field:"spu_name",title:t.$t("wms.deliveryManagement.spu_name")},null,8,["title"]),e(i,{field:"sku_code",title:t.$t("wms.deliveryManagement.sku_code")},null,8,["title"]),e(i,{field:"bar_code",title:t.$t("wms.deliveryManagement.bar_code")},null,8,["title"]),e(i,{field:"qty",title:t.$t("wms.deliveryManagement.order_qty")},null,8,["title"]),e(i,{field:"weight",title:t.$t("wms.deliveryManagement.detailWeight")},{default:n(({row:s})=>[u("span",null,v(`${s.weight} ${m(f)("weight",s.weight_unit)}`),1)]),_:1},8,["title"]),e(i,{field:"volume",title:t.$t("wms.deliveryManagement.detailVolume")},{default:n(({row:s})=>[u("span",null,v(`${s.volume} ${m(f)("volume",s.volume_unit)}`),1)]),_:1},8,["title"]),e(i,{field:"package_no",title:t.$t("wms.deliveryManagement.package_no")},null,8,["title"]),e(i,{field:"weighing_weight",title:t.$t("wms.deliveryManagement.weighing_weight")},{default:n(({row:s})=>[u("span",null,v(`${s.weighing_weight} ${m(f)("weight",s.weight_unit)}`),1)]),_:1},8,["title"]),e(i,{field:"weighing_no",title:t.$t("wms.deliveryManagement.weighing_no")},null,8,["title"]),e(i,{field:"customer_name",title:t.$t("wms.deliveryManagement.customer_name")},null,8,["title"]),e(i,{field:"creator",title:t.$t("wms.deliveryManagement.creator")},null,8,["title"]),e(i,{field:"create_time",width:"170px",title:t.$t("wms.deliveryManagement.create_time")},null,8,["title"]),e(i,{field:"operate",title:t.$t("system.page.operate"),width:"140",resizable:!1,"show-overflow":""},{default:n(({row:s})=>[u("div",Q,[e(L,{flat:!0,icon:"mdi-eye-outline","tooltip-text":t.$t("system.page.view"),onClick:te=>o.viewRow(s)},null,8,["tooltip-text","onClick"])])]),_:1},8,["title"])]),_:1},8,["data","height"]),e(I,{"current-page":a.tablePage.pageIndex,"page-size":a.tablePage.pageSize,perfect:"",total:a.tablePage.total,"page-sizes":m(F),layouts:m(S),onPageChange:o.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"]),e(U,{id:a.showDeliveredDetailID,"show-dialog":a.showDeliveredDetail,onClose:o.closeDeliveredDetail},null,8,["id","show-dialog","onClose"])],4)],64)}}});const be=Y(X,[["__scopeId","data-v-58f13169"]]);export{be as default};
