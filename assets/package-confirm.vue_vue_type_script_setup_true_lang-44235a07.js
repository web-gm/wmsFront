import{a as p}from"./index-cd6d6b34.js";import{i as s}from"./i18n-0af8b262.js";import{a as _,I as y}from"./formRule-3feb276f.js";import{d as Q,r as V,b as S,a as i,x as v,v as f,s as n,q as t,m as T,b0 as B,O as L,y as $,at as k,e as W}from"./runtime-core.esm-bundler-1bbee395.js";const O=Q({__name:"package-confirm",props:{isWeight:{type:Boolean},isSignIn:{type:Boolean},dialogTitle:null},emits:["close","submit"],setup(u,{expose:M,emit:b}){const w=u,a=V({showDialog:!1,list:S([]),rules:{qty:[],weight:[l=>!!l||`${s.global.t("system.checkText.mustInput")}${s.global.t("wms.deliveryManagement.detailQty")}!`,l=>_(l,"nonNegative",15,3)===""||_(l,"nonNegative",15,3)]}}),g=V({openDialog:(l=[])=>{a.list=l,w.isSignIn?a.rules.qty=[]:a.rules.qty=[e=>!!e||`${s.global.t("system.checkText.mustInput")}${s.global.t("wms.deliveryManagement.detailQty")}!`,e=>y(e,"greaterThanZero")===""||y(e,"greaterThanZero")],a.showDialog=!0},closeDialog:()=>{a.showDialog=!1},submit:()=>{if(w.isSignIn){const l=a.list.filter(e=>y(e.qty,"nonNegative")!==""||Number(e.qty)<0||Number(e.qty)>e.maxQty);if(l.length>0){const e=l.map(d=>`${d.sku_code}: ${s.global.t("wms.deliveryManagement.exceedingQuantity")}${d.maxQty}`);p.$message({type:"error",content:`${s.global.t("wms.deliveryManagement.invalidValue")}; ${e.join("; ")}`})}else p.$dialog({content:`${s.global.t("wms.deliveryManagement.irreversible")}, ${s.global.t("wms.deliveryManagement.confirmSignIn")}?`,handleConfirm:async()=>{b("submit",a.list)}})}else{const l=a.list.filter(e=>y(e.qty,"greaterThanZero")!==""||Number(e.qty)<=0||Number(e.qty)>e.maxQty||e.weight&&_(e.weight,"nonNegative",15,3)!=="");if(l.length>0){const e=l.map(d=>`${d.sku_code}: ${s.global.t("wms.deliveryManagement.exceedingQuantity")}${d.maxQty}`);p.$message({type:"error",content:`${s.global.t("wms.deliveryManagement.invalidValue")}; ${e.join("; ")}`})}else b("submit",a.list)}}});return M({openDialog:g.openDialog,closeDialog:g.closeDialog}),(l,e)=>{const d=i("v-toolbar"),m=i("v-text-field"),c=i("v-col"),D=i("v-row"),q=i("v-form"),x=i("v-card-text"),h=i("v-btn"),C=i("v-card-actions"),I=i("v-card"),N=i("v-dialog");return v(),f(N,{modelValue:a.showDialog,"onUpdate:modelValue":e[0]||(e[0]=o=>a.showDialog=o),width:"70%",transition:"dialog-top-transition",persistent:!0},{default:n(()=>[t(I,{class:"formCard"},{default:n(()=>[t(d,{color:"white",title:u.dialogTitle},null,8,["title"]),t(x,null,{default:n(()=>[t(q,{ref:"formRef"},{default:n(()=>[(v(!0),T(L,null,B(a.list,(o,U)=>(v(),f(D,{key:U},{default:n(()=>[t(c,{cols:3},{default:n(()=>[t(m,{modelValue:o.spu_name,"onUpdate:modelValue":r=>o.spu_name=r,label:l.$t("wms.deliveryManagement.spu_name"),variant:"outlined",readonly:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),t(c,{cols:3},{default:n(()=>[t(m,{modelValue:o.spu_code,"onUpdate:modelValue":r=>o.spu_code=r,label:l.$t("wms.deliveryManagement.spu_code"),variant:"outlined",readonly:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),t(c,{cols:u.isWeight?2:3},{default:n(()=>[t(m,{modelValue:o.sku_code,"onUpdate:modelValue":r=>o.sku_code=r,label:l.$t("wms.deliveryManagement.sku_code"),variant:"outlined",readonly:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1032,["cols"]),t(c,{cols:u.isWeight?2:3},{default:n(()=>[t(m,{modelValue:o.qty,"onUpdate:modelValue":r=>o.qty=r,rules:a.rules.qty,label:u.isSignIn?l.$t("wms.deliveryManagement.damagedQuantity"):l.$t("wms.deliveryManagement.detailQty"),variant:"outlined",clearable:""},null,8,["modelValue","onUpdate:modelValue","rules","label"])]),_:2},1032,["cols"]),u.isWeight?(v(),f(c,{key:0,cols:2},{default:n(()=>[t(m,{modelValue:o.weight,"onUpdate:modelValue":r=>o.weight=r,rules:a.rules.weight,label:l.$t("wms.deliveryManagement.detailWeight")+"("+o.weight_unit+")",variant:"outlined",clearable:""},null,8,["modelValue","onUpdate:modelValue","rules","label"])]),_:2},1024)):W("",!0)]),_:2},1024))),128))]),_:1},512)]),_:1}),t(C,{class:"justify-end"},{default:n(()=>[t(h,{variant:"text",onClick:g.closeDialog},{default:n(()=>[$(k(l.$t("system.page.close")),1)]),_:1},8,["onClick"]),t(h,{color:"primary",variant:"text",onClick:g.submit},{default:n(()=>[$(k(l.$t("system.page.submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{O as _};
