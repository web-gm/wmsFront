import{i as u,w as v}from"./i18n-0af8b262.js";import{a as D,b as $}from"./style-b9bc59b4.js";import{D as L,a as P,c as q,P as C,b as F}from"./system-93ae242b.js";import{a as T}from"./index-cd6d6b34.js";import{g as V,s as x}from"./common-938b41ea.js";import{g as E}from"./stockAsn-18b92b84.js";import z from"./sku-info-138df2f3.js";import{e as O}from"./exportTable-b0d17537.js";import{B as R}from"./btnGroup-26ff2079.js";import B from"./view-detail-dialog-e234b4c2.js";import{d as N,b as i,r as p,o as M,c as w,w as U,a as c,x as G,m as H,u as f,q as e,s as n,y as j,at as k,ap as d,aq as K,as as J,O as Z}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./index-ae8f073f.js";import"./vue-router-1283ad2d.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";const Y={class:"operateArea"},Q=["onClick"],X=N({__name:"tabReceiptDetails",setup(ee,{expose:y}){const g=i(),_=i(),a=p({showDialog:!1,showDialogShowInfo:!1,searchForm:{supplier_name:"",sku_name:""},activeTab:null,tableData:i([]),dialogForm:i({id:0,asn_no:"",asn_batch:"",estimated_arrival_time:"",detailList:[]}),tablePage:p({total:0,sqlTitle:"asn_status:4",pageIndex:1,pageSize:L,searchObjects:i([])}),timer:i(null),btnList:[],authorityList:V()}),l=p({viewRow:t=>{_.value.openDialog(t.id)},closeDialogShowInfo:()=>{a.showDialogShowInfo=!1},showSkuInfo(t){a.dialogForm=JSON.parse(JSON.stringify(t)),a.showDialogShowInfo=!0},refresh:()=>{l.getStockAsnList()},getStockAsnList:async()=>{const{data:t}=await E(a.tablePage);if(!t.isSuccess){T.$message({type:"error",content:t.errorMessage});return}a.tableData=t.data.rows,a.tablePage.total=t.data.totals},handlePageChange:i(({currentPage:t,pageSize:s})=>{a.tablePage.pageIndex=t,a.tablePage.pageSize=s,l.getStockAsnList()}),exportTable:()=>{const t=g.value;O({table:t,filename:u.global.t("wms.stockAsn.tabReceiptDetails"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})},sureSearch:()=>{a.tablePage.searchObjects=x(a.searchForm),l.getStockAsnList()}});M(()=>{a.btnList=[{name:u.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:l.refresh},{name:u.global.t("system.page.export"),icon:"mdi-export-variant",code:"detail-export",click:l.exportTable}]});const I=w(()=>D({})),A=w(()=>$({}));return y({getStockAsnList:l.getStockAsnList}),U(()=>a.searchForm,()=>{a.timer&&clearTimeout(a.timer),a.timer=setTimeout(()=>{a.timer=null,l.sureSearch()},P)},{deep:!0}),(t,s)=>{const m=c("v-col"),h=c("v-text-field"),b=c("v-row"),o=c("vxe-column"),S=c("vxe-table");return G(),H(Z,null,[f("div",Y,[e(b,{"no-gutters":""},{default:n(()=>[e(m,{cols:"3",class:"col"},{default:n(()=>[e(R,{"authority-list":a.authorityList,"btn-list":a.btnList},null,8,["authority-list","btn-list"])]),_:1}),e(m,{cols:"9"},{default:n(()=>[e(b,{"no-gutters":"",onKeyup:v(l.sureSearch,["enter"])},{default:n(()=>[e(m,{cols:"4"}),e(m,{cols:"4"},{default:n(()=>[e(h,{modelValue:a.searchForm.supplier_name,"onUpdate:modelValue":s[0]||(s[0]=r=>a.searchForm.supplier_name=r),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.stockAsnInfo.supplier_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),e(m,{cols:"4"},{default:n(()=>[e(h,{modelValue:a.searchForm.sku_name,"onUpdate:modelValue":s[1]||(s[1]=r=>a.searchForm.sku_name=r),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.stockAsnInfo.sku_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),f("div",{class:"mt-5",style:J({height:d(I)})},[e(S,{ref_key:"xTableStockLocation",ref:g,"column-config":{minWidth:"100px"},data:a.tableData,height:d(A),align:"center"},{empty:n(()=>[j(k(d(u).global.t("system.page.noData")),1)]),default:n(()=>[e(o,{type:"seq",width:"60"}),e(o,{type:"checkbox",width:"50"}),e(o,{field:"asn_no",title:t.$t("wms.stockAsnInfo.asn_no")},null,8,["title"]),e(o,{field:"spu_code",title:t.$t("wms.stockAsnInfo.spu_code")},null,8,["title"]),e(o,{field:"spu_name",title:t.$t("wms.stockAsnInfo.spu_name")},null,8,["title"]),e(o,{field:"sku_code",title:t.$t("wms.stockAsnInfo.sku_code")},{default:n(({row:r})=>[f("div",{class:K("text-decoration-none"),onClick:te=>l.showSkuInfo(r)},k(r.sku_code),9,Q)]),_:1},8,["title"]),e(o,{field:"sku_name",title:t.$t("wms.stockAsnInfo.sku_name")},null,8,["title"]),e(o,{field:"goods_owner_name",title:t.$t("wms.stockAsnInfo.goods_owner_name")},null,8,["title"]),e(o,{field:"supplier_name",title:t.$t("wms.stockAsnInfo.supplier_name")},null,8,["title"]),e(o,{field:"asn_qty",title:t.$t("wms.stockAsnInfo.asn_qty")},null,8,["title"]),e(o,{field:"weight",title:t.$t("wms.stockAsnInfo.weight")},null,8,["title"]),e(o,{field:"volume",title:t.$t("wms.stockAsnInfo.volume")},null,8,["title"]),e(o,{field:"actual_qty",title:t.$t("wms.stockAsnInfo.actual_qty")},null,8,["title"]),e(o,{field:"sorted_qty",title:t.$t("wms.stockAsnInfo.sorted_qty")},null,8,["title"]),e(o,{field:"shortage_qty",title:t.$t("wms.stockAsnInfo.shortage_qty")},null,8,["title"]),e(o,{field:"more_qty",title:t.$t("wms.stockAsnInfo.more_qty")},null,8,["title"]),e(o,{field:"damage_qty",title:t.$t("wms.stockAsnInfo.damage_qty")},null,8,["title"])]),_:1},8,["data","height"]),e(q,{"current-page":a.tablePage.pageIndex,"page-size":a.tablePage.pageSize,perfect:"",total:a.tablePage.total,"page-sizes":d(C),layouts:d(F),onPageChange:l.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4),e(z,{"show-dialog":a.showDialogShowInfo,form:a.dialogForm,onClose:l.closeDialogShowInfo},null,8,["show-dialog","form","onClose"]),e(B,{ref_key:"ViewDetailDialogRef",ref:_},null,512)],64)}}});const ke=W(X,[["__scopeId","data-v-6bdb7dcc"]]);export{ke as default};
