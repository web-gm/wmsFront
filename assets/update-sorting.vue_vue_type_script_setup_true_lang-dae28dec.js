import{i as d}from"./i18n-0af8b262.js";import{a as p}from"./index-cd6d6b34.js";import{S as V,e as M}from"./style-b9bc59b4.js";import{x as T}from"./stockAsn-18b92b84.js";import{_ as q}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{a as S}from"./tableRule-6aa0c57f.js";import{d as E,b as I,r as y,a as i,x as A,v as R,s as a,q as t,ap as _,y as f,at as v}from"./runtime-core.esm-bundler-1bbee395.js";const G=E({__name:"update-sorting",emits:["sure"],setup(U,{expose:h,emit:D}){const m=I(),l=y({showDialog:!1,tableData:[],validRules:{sorted_qty:[{required:!0,message:`${d.global.t("system.checkText.mustInput")}${d.global.t("wms.stockAsnInfo.sorted_qty")}`},{validator:S,validNumerical:"nonNegative",trigger:"change"}],series_number:[{type:"string",min:0,max:64,message:`${d.global.t("system.checkText.lengthValid")}${0}-${64}`,trigger:"change"}]}}),r=y({activeMethod({row:e,column:o}){return!(!e.series_number&&o.field==="series_number")},deleteRow:e=>{const o=m.value;p.$dialog({content:d.global.t("system.tips.beforeDeleteDetailMessage"),handleConfirm:async()=>{o.remove(e)}})},initDialogData:async e=>{const{data:o}=await T(e);if(!o.isSuccess){p.$message({type:"error",content:o.errorMessage}),l.showDialog=!1;return}l.tableData=o.data},openDialog:async e=>{r.initDialogData(e),l.showDialog=!0},closeDialog:()=>{l.showDialog=!1},submit:async()=>{if(await m.value.validate(!0))p.$message({type:"error",content:d.global.t("system.checkText.checkFormFail")});else{const u=m.value.getRemoveRecords();if(u)for(const c of u)c.id=0-c.id;const n=l.tableData;D("sure",n)}}});return h({openDialog:r.openDialog,closeDialog:r.closeDialog}),(e,o)=>{const u=i("v-toolbar"),n=i("vxe-column"),c=i("vxe-input"),$=i("vxe-table"),k=i("v-card-text"),b=i("v-btn"),w=i("v-card-actions"),x=i("v-card"),C=i("v-dialog");return A(),R(C,{modelValue:l.showDialog,"onUpdate:modelValue":o[0]||(o[0]=s=>l.showDialog=s),width:"70%",transition:"dialog-top-transition",persistent:!0},{default:a(()=>[t(x,null,{default:a(()=>[t(u,{color:"white",title:`${e.$t("wms.stockAsnInfo.editSorting")}`},null,8,["title"]),t(k,null,{default:a(()=>[t($,{ref_key:"xTable",ref:m,"keep-source":"","column-config":{minWidth:"100px"},data:l.tableData,height:_(V).SELECT_TABLE,align:"center","edit-rules":l.validRules,"edit-config":{trigger:"click",mode:"cell",activeMethod:r.activeMethod},"mouse-config":{selected:!0},"keyboard-config":{isArrow:!0,isDel:!0,isEnter:!0,isTab:!0,isEdit:!0,isChecked:!0}},{empty:a(()=>[f(v(_(d).global.t("system.page.noData")),1)]),default:a(()=>[t(n,{type:"seq",width:"60"}),t(n,{field:"series_number",title:e.$t("wms.stockAsnInfo.series_number"),"edit-render":{autofocus:".vxe-input--inner"}},{edit:a(({row:s})=>[t(c,{modelValue:s.series_number,"onUpdate:modelValue":g=>s.series_number=g,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["title","edit-render"]),t(n,{field:"sorted_qty",title:e.$t("wms.stockAsnInfo.sorted_qty"),"edit-render":{autofocus:".vxe-input--inner"}},{edit:a(({row:s})=>[t(c,{modelValue:s.sorted_qty,"onUpdate:modelValue":g=>s.sorted_qty=g,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["title","edit-render"]),t(n,{field:"creator",title:e.$t("wms.deliveryManagement.creator")},null,8,["title"]),t(n,{field:"create_time",formatter:["formatDate","yyyy-MM-dd"],title:e.$t("wms.deliveryManagement.create_time")},null,8,["title"]),t(n,{field:"operate",title:e.$t("system.page.operate"),width:"100",resizable:!1,"show-overflow":""},{default:a(({row:s})=>[t(q,{flat:!0,icon:"mdi-delete-outline","tooltip-text":e.$t("system.page.delete"),"icon-color":_(M),onClick:g=>r.deleteRow(s)},null,8,["tooltip-text","icon-color","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height","edit-rules","edit-config"])]),_:1}),t(w,{class:"justify-end"},{default:a(()=>[t(b,{variant:"text",onClick:r.closeDialog},{default:a(()=>[f(v(e.$t("system.page.close")),1)]),_:1},8,["onClick"]),t(b,{color:"primary",variant:"text",onClick:r.submit},{default:a(()=>[f(v(e.$t("system.page.submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{G as _};
