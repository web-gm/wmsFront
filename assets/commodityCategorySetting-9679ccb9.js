import{a as D,b as $,e as k}from"./style-b9bc59b4.js";import{_ as f}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{g as T,d as F}from"./commodityCategorySetting-2425a593.js";import{a as d}from"./index-cd6d6b34.js";import L from"./add-or-update-category-4b7c4982.js";import{i}from"./i18n-0af8b262.js";import{e as M}from"./exportTable-b0d17537.js";import{B}from"./btnGroup-26ff2079.js";import{g as H}from"./common-938b41ea.js";import{d as N,b as R,r as u,o as A,c as _,a as l,x as O,m as V,u as m,q as o,s as r,as as q,ap as c,y as z,at as J}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./formRule-3feb276f.js";import"./index-ae8f073f.js";const G={class:"container"},I={class:"operateArea"},P=N({__name:"commodityCategorySetting",setup(U){const g=R(),e=u({tableData:[],tableTreeConfig:{transform:!0,rowField:"id",parentField:"parent_id"},showDialog:!1,dialogForm:{id:0,category_name:""},btnList:[],authorityList:H()}),a=u({sureSearch:()=>{},getCommodityCategorySetting:async()=>{const{data:t}=await T();if(!t.isSuccess){d.$message({type:"error",content:t.errorMessage});return}e.tableData=t.data},add:()=>{e.dialogForm={id:0,category_name:""},e.showDialog=!0},closeDialog:()=>{e.showDialog=!1},saveSuccess:()=>{a.refresh(),a.closeDialog()},refresh:()=>{a.getCommodityCategorySetting()},editRow(t){e.dialogForm=JSON.parse(JSON.stringify(t)),e.dialogForm.parent_id===0&&delete e.dialogForm.parent_id,e.showDialog=!0},deleteRow(t){d.$dialog({content:i.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(t.id){const{data:s}=await F(t.id);if(!s.isSuccess){d.$message({type:"error",content:s.errorMessage});return}d.$message({type:"success",content:`${i.global.t("system.page.delete")}${i.global.t("system.tips.success")}`}),a.refresh()}}})},exportTable:()=>{const t=g.value;M({table:t,filename:i.global.t("router.sideBar.commodityCategorySetting"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})}});A(async()=>{await a.getCommodityCategorySetting(),e.btnList=[{name:i.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:a.add},{name:i.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:a.refresh},{name:i.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:a.exportTable}]});const h=_(()=>D({hasTab:!1})),b=_(()=>$({hasTab:!1,hasPager:!1}));return(t,s)=>{const p=l("v-col"),v=l("v-row"),n=l("vxe-column"),C=l("vxe-table"),S=l("v-card-text"),w=l("v-card");return O(),V("div",G,[m("div",null,[o(w,{class:"mt-5"},{default:r(()=>[o(S,null,{default:r(()=>[m("div",I,[o(v,{"no-gutters":""},{default:r(()=>[o(p,{cols:"12",sm:"4",class:"col"},{default:r(()=>[o(B,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),o(p,{cols:"12",sm:"8"})]),_:1})]),m("div",{class:"mt-5",style:q({height:c(h)})},[o(C,{ref_key:"xTable",ref:g,data:e.tableData,height:c(b),"tree-config":e.tableTreeConfig,align:"center"},{empty:r(()=>[z(J(c(i).global.t("system.page.noData")),1)]),default:r(()=>[o(n,{type:"seq",width:"80"}),o(n,{field:"category_name",align:"left",title:t.$t("base.commodityCategorySetting.category_name"),"tree-node":""},null,8,["title"]),o(n,{field:"creator",title:t.$t("base.commodityCategorySetting.creator")},null,8,["title"]),o(n,{field:"create_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:t.$t("base.commodityCategorySetting.create_time")},null,8,["title"]),o(n,{title:t.$t("system.page.operate"),width:"160",resizable:!1,"show-overflow":""},{default:r(({row:y})=>[o(f,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":t.$t("system.page.edit"),disabled:!e.authorityList.includes("save"),onClick:x=>a.editRow(y)},null,8,["tooltip-text","disabled","onClick"]),o(f,{flat:!0,icon:"mdi-delete-outline","tooltip-text":t.$t("system.page.delete"),"icon-color":e.authorityList.includes("delete")?c(k):"",disabled:!e.authorityList.includes("delete"),onClick:x=>a.deleteRow(y)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height","tree-config"])],4)]),_:1})]),_:1})]),o(L,{"show-dialog":e.showDialog,form:e.dialogForm,onClose:a.closeDialog,onSaveSuccess:a.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"])])}}});const ce=E(P,[["__scopeId","data-v-13dc46a9"]]);export{ce as default};
