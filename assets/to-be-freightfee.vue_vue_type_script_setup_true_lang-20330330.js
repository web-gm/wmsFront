import{a as U}from"./index-cd6d6b34.js";import{i as D}from"./i18n-0af8b262.js";import{g as H}from"./freightSetting-4f9f7a61.js";import{_ as T}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{D as N,a as q,c as Y,P as Z,b as W}from"./system-93ae242b.js";import{f as J}from"./formatSystem-1203ad16.js";import{c as K,S as Q}from"./style-b9bc59b4.js";import{s as R}from"./common-938b41ea.js";import{d as z,b as S,c as P,r as b,w as F,a as i,x as L,v as M,s as r,q as e,u as k,as as X,ap as u,y as v,at as _,ac as I}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";import{S as E}from"./formRule-3feb276f.js";const te={class:"dataTable"},ae=z({__name:"freight-select",props:{showDialog:{type:Boolean}},emits:["close","sureSelect"],setup(w,{emit:g}){const $=w,p=S(),o=P(()=>$.showDialog),t=b({tableData:[],tablePage:b({total:0,pageIndex:1,pageSize:N,searchObjects:S([])}),searchForm:{carrier:"",departure_city:"",arrival_city:""},timer:S(null)}),l=b({handlePageChange:S(({currentPage:a,pageSize:n})=>{t.tablePage.pageIndex=a,t.tablePage.pageSize=n,l.getList()}),sureSearch:()=>{t.tablePage.searchObjects=R(t.searchForm),l.getList()},getList:async()=>{const{data:a}=await H(t.tablePage);if(!a.isSuccess){U.$message({type:"error",content:a.errorMessage});return}t.tableData=a.data.rows,t.tablePage.total=a.data.totals},resetForm:()=>{for(const a in t.searchForm){const n=a;t.searchForm[n]=""}t.tablePage.searchObjects=[]},submit:()=>{const a=p.value.getCheckboxRecords();g("sureSelect",a),l.closeDialog()},closeDialog:()=>{g("close")}}),s=P(()=>K({}));return F(()=>o.value,a=>{a&&l.getList()}),F(()=>t.searchForm,()=>{t.timer&&clearTimeout(t.timer),t.timer=setTimeout(()=>{t.timer=null,l.sureSearch()},q)},{deep:!0}),(a,n)=>{const V=i("v-toolbar"),f=i("v-text-field"),y=i("v-form"),h=i("v-col"),c=i("vxe-column"),C=i("vxe-table"),m=i("v-row"),B=i("v-card-text"),x=i("v-btn"),j=i("v-card-actions"),A=i("v-card"),O=i("v-dialog");return L(),M(O,{modelValue:u(o),"onUpdate:modelValue":n[3]||(n[3]=d=>I(o)?o.value=d:null),width:"70%",transition:"dialog-top-transition",persistent:!0},{default:r(()=>[e(A,null,{default:r(()=>[e(V,{color:"white",title:`${a.$t("base.freightSetting.freightSelectModal")}`},null,8,["title"]),e(B,null,{default:r(()=>[e(m,null,{default:r(()=>[e(h,{cols:"3"},{default:r(()=>[k("div",{class:"searchForm",style:X({height:u(s)})},[e(T,{icon:"mdi-refresh",size:"x-small","tooltip-text":a.$t("system.page.reset"),onClick:l.resetForm},null,8,["tooltip-text","onClick"]),e(T,{icon:"mdi-magnify",size:"x-small","tooltip-text":a.$t("system.page.confirm"),onClick:l.sureSearch},null,8,["tooltip-text","onClick"]),e(y,{ref:"formRef",class:"mt-4"},{default:r(()=>[e(f,{modelValue:t.searchForm.carrier,"onUpdate:modelValue":n[0]||(n[0]=d=>t.searchForm.carrier=d),label:a.$t("base.freightSetting.carrier"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"]),e(f,{modelValue:t.searchForm.departure_city,"onUpdate:modelValue":n[1]||(n[1]=d=>t.searchForm.departure_city=d),label:a.$t("base.freightSetting.departure_city"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"]),e(f,{modelValue:t.searchForm.arrival_city,"onUpdate:modelValue":n[2]||(n[2]=d=>t.searchForm.arrival_city=d),label:a.$t("base.freightSetting.arrival_city"),variant:"outlined",density:"compact","hide-details":"",clearable:"",class:"mb-4"},null,8,["modelValue","label"])]),_:1},512)],4)]),_:1}),e(h,{cols:"9"},{default:r(()=>[k("div",te,[e(C,{ref_key:"xTable",ref:p,"column-config":{minWidth:"100px"},data:t.tableData,height:u(Q).SELECT_TABLE,align:"center"},{empty:r(()=>[v(_(u(D).global.t("system.page.noData")),1)]),default:r(()=>[e(c,{type:"seq",width:"60"}),e(c,{type:"checkbox",width:"50"}),e(c,{field:"carrier",title:a.$t("base.freightSetting.carrier")},null,8,["title"]),e(c,{field:"departure_city",title:a.$t("base.freightSetting.departure_city")},null,8,["title"]),e(c,{field:"arrival_city",title:a.$t("base.freightSetting.arrival_city")},null,8,["title"]),e(c,{field:"price_per_weight",title:a.$t("base.freightSetting.price_per_weight")},null,8,["title"]),e(c,{field:"price_per_volume",title:a.$t("base.freightSetting.price_per_volume")},null,8,["title"]),e(c,{field:"min_payment",title:a.$t("base.freightSetting.min_payment")},null,8,["title"]),e(c,{field:"creator",title:a.$t("base.freightSetting.creator")},null,8,["title"]),e(c,{field:"create_time",width:"170px",title:a.$t("base.freightSetting.create_time")},null,8,["title"]),e(c,{field:"is_valid",title:a.$t("base.warehouseSetting.is_valid")},{default:r(({row:d,column:G})=>[k("span",null,_(u(J)(d[G.property])),1)]),_:1},8,["title"])]),_:1},8,["data","height"]),e(Y,{"current-page":t.tablePage.pageIndex,"page-size":t.tablePage.pageSize,perfect:"",total:t.tablePage.total,"page-sizes":u(Z),layouts:u(W),onPageChange:l.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])])]),_:1})]),_:1})]),_:1}),e(j,{class:"justify-end"},{default:r(()=>[e(x,{variant:"text",onClick:l.closeDialog},{default:r(()=>[v(_(a.$t("system.page.close")),1)]),_:1},8,["onClick"]),e(x,{color:"primary",variant:"text",onClick:l.submit},{default:r(()=>[v(_(a.$t("system.page.confirm")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const le=ee(ae,[["__scopeId","data-v-91a6d086"]]),ge=z({__name:"to-be-freightfee",props:{showDialog:{type:Boolean}},emits:["close","submit"],setup(w,{emit:g}){const $=w,p=P(()=>$.showDialog),o=b({dialogSelect:!1,form:{carrier:"",freightfee_id:0,departure_city:"",arrival_city:"",waybill_no:""},combobox:{freightfee_id:[]},rules:{waybill_no:[l=>E(l,0,64)===""||E(l,0,64)]}}),t=b({openSelect:()=>{o.dialogSelect=!0},closeDialogSelect:()=>{o.dialogSelect=!1},sureSelect:l=>{l.length>0&&(o.form.carrier=l[0].carrier,o.form.freightfee_id=l[0].id?l[0].id:0,o.form.departure_city=l[0].departure_city,o.form.arrival_city=l[0].arrival_city)},valClearable:()=>{o.form={carrier:"",freightfee_id:0,departure_city:"",arrival_city:"",waybill_no:o.form.waybill_no}},closeDialog:()=>{g("close")},submit:()=>{o.form.carrier?g("submit",o.form):U.$message({type:"error",content:`${D.global.t("system.checkText.mustSelect")}${D.global.t("wms.deliveryManagement.carrier")}!`})}});return F(()=>p.value,l=>{l&&(o.form={carrier:"",freightfee_id:0,departure_city:"",arrival_city:"",waybill_no:""})}),(l,s)=>{const a=i("v-toolbar"),n=i("v-text-field"),V=i("v-form"),f=i("v-card-text"),y=i("v-btn"),h=i("v-card-actions"),c=i("v-card"),C=i("v-dialog");return L(),M(C,{modelValue:u(p),"onUpdate:modelValue":s[6]||(s[6]=m=>I(p)?p.value=m:null),width:"30%",transition:"dialog-top-transition",persistent:!0},{default:r(()=>[e(c,{class:"formCard"},{default:r(()=>[e(a,{color:"white",title:`${l.$t("wms.deliveryManagement.setFreight")}`},null,8,["title"]),e(f,null,{default:r(()=>[e(V,{ref:"formRef"},{default:r(()=>[e(n,{modelValue:o.form.waybill_no,"onUpdate:modelValue":s[0]||(s[0]=m=>o.form.waybill_no=m),rules:o.rules.waybill_no,label:l.$t("wms.deliveryManagement.waybill_no"),variant:"outlined",clearable:""},null,8,["modelValue","rules","label"]),e(n,{modelValue:o.form.carrier,"onUpdate:modelValue":s[1]||(s[1]=m=>o.form.carrier=m),label:l.$t("wms.deliveryManagement.carrier"),variant:"outlined",readonly:"",clearable:"",onClick:s[2]||(s[2]=m=>t.openSelect()),"onClick:clear":t.valClearable},null,8,["modelValue","label","onClick:clear"]),e(n,{modelValue:o.form.departure_city,"onUpdate:modelValue":s[3]||(s[3]=m=>o.form.departure_city=m),label:l.$t("wms.deliveryManagement.departure_city"),variant:"outlined",readonly:""},null,8,["modelValue","label"]),e(n,{modelValue:o.form.arrival_city,"onUpdate:modelValue":s[4]||(s[4]=m=>o.form.arrival_city=m),label:l.$t("wms.deliveryManagement.arrival_city"),variant:"outlined",readonly:""},null,8,["modelValue","label"])]),_:1},512)]),_:1}),e(h,{class:"justify-end"},{default:r(()=>[e(y,{variant:"text",onClick:t.closeDialog},{default:r(()=>[v(_(l.$t("system.page.close")),1)]),_:1},8,["onClick"]),e(y,{color:"primary",variant:"text",onClick:t.submit},{default:r(()=>[v(_(l.$t("system.page.submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),e(le,{"show-dialog":o.dialogSelect,onClose:s[5]||(s[5]=m=>t.closeDialogSelect()),onSureSelect:t.sureSelect},null,8,["show-dialog","onSureSelect"])]),_:1},8,["modelValue"])}}});export{ge as _};
