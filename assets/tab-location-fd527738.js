import{i as r,w as R}from"./i18n-0af8b262.js";import{a as F,b as G,e as B}from"./style-b9bc59b4.js";import{D as E,a as I,c as T,P as M,b as V}from"./system-93ae242b.js";import{a as h}from"./index-cd6d6b34.js";import{j as z,k as A}from"./warehouseSetting-835f9e1c.js";import{f as O}from"./formatSystem-1203ad16.js";import{f as N}from"./formatWarehouse-aebb7b18.js";import{g as Q,s as U}from"./common-938b41ea.js";import{e as q}from"./exportTable-b0d17537.js";import{_ as $}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import j from"./add-or-update-location-e958a80f.js";import{B as H}from"./btnGroup-26ff2079.js";import{B as K}from"./barCodeDialog-3972f0b1.js";import{Q as J}from"./qrCodeDialog-8c21caa4.js";import{d as Z,b as c,r as f,o as W,c as L,w as Y,a as _,x as X,m as ee,u as m,q as a,s as n,at as d,ap as u,as as te,y as w,O as ae}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";import"./Warehouse-56a6b193.js";import"./formRule-3feb276f.js";import"./JsBarcode-61cdf20e.js";import"./JsBarcode-3dd77e18.js";import"./vue-qr-da17c00d.js";const le={class:"operateArea"},se=Z({__name:"tab-location",setup(ie,{expose:D}){const g=c(),y=c(),v=c(),t=f({showDialog:!1,dialogForm:c({id:0,warehouse_name:"",warehouse_area_name:"",location_name:"",location_length:0,location_width:0,location_heigth:0,location_volume:0,location_load:0,roadway_number:"",shelf_number:"",layer_number:"",tag_number:"",is_valid:!0}),searchForm:{warehouse_name:"",warehouse_area_name:""},activeTab:null,tableData:c([]),tablePage:f({total:0,pageIndex:1,pageSize:E,searchObjects:c([])}),selectRowData:[],timer:c(null),btnList:[],authorityList:Q()}),l=f({printQrCode:()=>{const e=g.value.getCheckboxRecords();if(e.length>0){for(const o of e)o.type="warehouse";y.value.openDialog(e)}else h.$message({type:"error",content:r.global.t("base.userManagement.checkboxIsNull")})},printBarCode:()=>{let e=g.value.getCheckboxRecords();e=e.filter(o=>o.id),e.length>0?v.value.openDialog(e):h.$message({type:"error",content:r.global.t("base.userManagement.checkboxIsNull")})},selectAllEvent({checked:e}){const o=g.value.getCheckboxRecords();e?t.selectRowData=o:t.selectRowData=[]},selectChangeEvent(){t.selectRowData=g.value.getCheckboxRecords()},add:()=>{t.dialogForm={id:0,warehouse_name:"",warehouse_area_name:"",location_name:"",location_length:0,location_width:0,location_heigth:0,location_volume:0,location_load:0,roadway_number:"",shelf_number:"",layer_number:"",tag_number:"",is_valid:!0},t.showDialog=!0},closeDialog:()=>{t.showDialog=!1},saveSuccess:()=>{l.refresh(),l.closeDialog()},refresh:()=>{l.getGoodsLocationList()},getGoodsLocationList:async()=>{const{data:e}=await z(t.tablePage);if(!e.isSuccess){h.$message({type:"error",content:e.errorMessage});return}t.tableData=e.data.rows,t.tablePage.total=e.data.totals},editRow(e){t.dialogForm=JSON.parse(JSON.stringify(e)),t.showDialog=!0},deleteRow(e){h.$dialog({content:r.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(e.id){const{data:o}=await A(e.id);if(!o.isSuccess){h.$message({type:"error",content:o.errorMessage});return}h.$message({type:"success",content:`${r.global.t("system.page.delete")}${r.global.t("system.tips.success")}`}),l.refresh()}}})},handlePageChange:c(({currentPage:e,pageSize:o})=>{t.tablePage.pageIndex=e,t.tablePage.pageSize=o,l.getGoodsLocationList()}),exportTable:()=>{const e=g.value;q({table:e,filename:r.global.t("base.warehouseSetting.locationSetting"),columnFilterMethod({column:o}){return!["checkbox"].includes(o==null?void 0:o.type)&&!["operate"].includes(o==null?void 0:o.field)}})},sureSearch:()=>{t.tablePage.searchObjects=U(t.searchForm),l.getGoodsLocationList()}});W(()=>{t.btnList=[{name:r.global.t("system.page.add"),icon:"mdi-plus",code:"location-save",click:l.add},{name:r.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:l.refresh},{name:r.global.t("system.page.export"),icon:"mdi-export-variant",code:"location-export",click:l.exportTable},{name:r.global.t("base.commodityManagement.printQrCode"),icon:"mdi-qrcode",code:"location-printQrCode",click:l.printQrCode},{name:r.global.t("base.commodityManagement.printBarCode"),icon:"mdi-barcode",code:"location-printBarCode",click:l.printBarCode}]});const k=L(()=>F({})),x=L(()=>G({}));return Y(()=>t.searchForm,()=>{t.timer&&clearTimeout(t.timer),t.timer=setTimeout(()=>{t.timer=null,l.sureSearch()},I)},{deep:!0}),D({getGoodsLocationList:l.getGoodsLocationList}),(e,o)=>{const p=_("v-col"),S=_("v-text-field"),C=_("v-row"),s=_("vxe-column"),P=_("vxe-table");return X(),ee(ae,null,[m("div",le,[a(C,{"no-gutters":""},{default:n(()=>[a(p,{cols:"3",class:"col"},{default:n(()=>[a(H,{"authority-list":t.authorityList,"btn-list":t.btnList},null,8,["authority-list","btn-list"])]),_:1}),a(p,{cols:"9"},{default:n(()=>[a(C,{"no-gutters":"",onKeyup:R(l.sureSearch,["enter"])},{default:n(()=>[a(p,{cols:"4"}),a(p,{cols:"4"},{default:n(()=>[a(S,{modelValue:t.searchForm.warehouse_name,"onUpdate:modelValue":o[0]||(o[0]=i=>t.searchForm.warehouse_name=i),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:e.$t("base.warehouseSetting.warehouse_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),a(p,{cols:"4"},{default:n(()=>[a(S,{modelValue:t.searchForm.warehouse_area_name,"onUpdate:modelValue":o[1]||(o[1]=i=>t.searchForm.warehouse_area_name=i),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:e.$t("base.warehouseSetting.area_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),m("div",{class:"mt-5",style:te({height:u(k)})},[a(P,{ref_key:"xTableGoodsLocation",ref:g,"column-config":{minWidth:"100px"},data:t.tableData,height:u(x),align:"center"},{default:n(()=>[a(s,{type:"checkbox",width:"50",fixed:"left"}),a(s,{type:"seq",width:"60"}),a(s,{field:"warehouse_name",title:e.$t("base.warehouseSetting.warehouse_name")},null,8,["title"]),a(s,{field:"warehouse_area_name",title:e.$t("base.warehouseSetting.area_name")},null,8,["title"]),a(s,{field:"warehouse_area_property",title:e.$t("base.warehouseSetting.area_property")},{default:n(({row:i,column:b})=>[m("span",null,d(u(N)(i[b.property])),1)]),_:1},8,["title"]),a(s,{field:"location_name",title:e.$t("base.warehouseSetting.location_name")},null,8,["title"]),a(s,{width:"150px",field:"location_length",title:e.$t("base.warehouseSetting.location_length")},null,8,["title"]),a(s,{width:"150px",field:"location_width",title:e.$t("base.warehouseSetting.location_width")},null,8,["title"]),a(s,{width:"150px",field:"location_heigth",title:e.$t("base.warehouseSetting.location_heigth")},null,8,["title"]),a(s,{width:"150px",field:"location_volume",title:e.$t("base.warehouseSetting.location_volume")},null,8,["title"]),a(s,{width:"150px",field:"location_load",title:e.$t("base.warehouseSetting.location_load")},null,8,["title"]),a(s,{field:"roadway_number",title:e.$t("base.warehouseSetting.roadway_number")},null,8,["title"]),a(s,{field:"shelf_number",title:e.$t("base.warehouseSetting.shelf_number")},null,8,["title"]),a(s,{field:"layer_number",title:e.$t("base.warehouseSetting.layer_number")},null,8,["title"]),a(s,{field:"tag_number",title:e.$t("base.warehouseSetting.tag_number")},null,8,["title"]),a(s,{field:"is_valid",title:e.$t("base.warehouseSetting.is_valid")},{default:n(({row:i,column:b})=>[m("span",null,d(u(O)(i[b.property])),1)]),_:1},8,["title"]),a(s,{field:"operate",title:e.$t("system.page.operate"),width:"140px",resizable:!1,"show-overflow":""},{default:n(({row:i})=>[a($,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":e.$t("system.page.edit"),disabled:!t.authorityList.includes("location-save"),onClick:b=>l.editRow(i)},null,8,["tooltip-text","disabled","onClick"]),a($,{flat:!0,icon:"mdi-delete-outline","tooltip-text":e.$t("system.page.delete"),"icon-color":u(B),disabled:!t.authorityList.includes("location-delete"),onClick:b=>l.deleteRow(i)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),a(T,{"current-page":t.tablePage.pageIndex,"page-size":t.tablePage.pageSize,perfect:"",total:t.tablePage.total,"page-sizes":u(M),layouts:u(V),onPageChange:l.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4),a(j,{"show-dialog":t.showDialog,form:t.dialogForm,onClose:l.closeDialog,onSaveSuccess:l.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"]),a(J,{ref_key:"qrCodeDialogRef",ref:y,menu:"warehouseSetting-location"},{left:n(({slotData:i})=>[m("p",null,d(e.$t("base.warehouseSetting.warehouse_name"))+":"+d(i.warehouse_name),1),w("   "),m("p",null,d(e.$t("base.warehouseSetting.area_name"))+":"+d(i.warehouse_area_name),1),w("   "),m("p",null,d(e.$t("base.warehouseSetting.location_name"))+":"+d(i.location_name),1),w("   ")]),_:1},512),a(K,{ref_key:"barCodeDialogRef",ref:v,menu:"warehouseSetting-location"},null,512)],64)}}});const Be=oe(se,[["__scopeId","data-v-292f9a29"]]);export{Be as default};
