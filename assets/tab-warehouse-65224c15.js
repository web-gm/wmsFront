import{i as n,w as C}from"./i18n-0af8b262.js";import{a as L,b as P,e as x}from"./style-b9bc59b4.js";import{D as F,a as k,c as W,P as T,b as V}from"./system-93ae242b.js";import{a as g}from"./index-cd6d6b34.js";import{g as E,n as z}from"./warehouseSetting-835f9e1c.js";import{_ as y}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import M from"./add-or-update-warehouse-b592f366.js";import{f as O}from"./formatSystem-1203ad16.js";import{g as A,s as U}from"./common-938b41ea.js";import B from"./import-table-181e2c8e.js";import{e as H}from"./exportTable-b0d17537.js";import{B as N}from"./btnGroup-26ff2079.js";import{d as G,b as c,r as f,o as R,c as S,w as j,a as u,x as K,m as q,u as b,q as a,s as i,at as J,ap as m,as as Z,O as Y}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./formRule-3feb276f.js";import"./index-ae8f073f.js";const X={class:"operateArea"},ee=G({__name:"tab-warehouse",setup(te,{expose:v}){const w=c(),e=f({showDialog:!1,showDialogImport:!1,dialogForm:{id:0,warehouse_name:"",city:"",address:"",contact_tel:"",email:"",manager:"",is_valid:!0},searchForm:{warehouse_name:"",city:"",manager:""},activeTab:null,tableData:c([]),tablePage:f({total:0,pageIndex:1,pageSize:F,searchObjects:c([])}),timer:c(null),btnList:[],authorityList:A()}),o=f({add:()=>{e.dialogForm={id:0,warehouse_name:"",city:"",address:"",contact_tel:"",email:"",manager:"",is_valid:!0},e.showDialog=!0},closeDialog:()=>{e.showDialog=!1},saveSuccess:()=>{o.refresh(),o.closeDialog()},openDialogImport:()=>{e.showDialogImport=!0},closeDialogImport:()=>{e.showDialogImport=!1},saveSuccessImport:()=>{o.refresh(),o.closeDialogImport()},refresh:()=>{o.getWarehouseList()},getWarehouseList:async()=>{const{data:t}=await E(e.tablePage);if(!t.isSuccess){g.$message({type:"error",content:t.errorMessage});return}e.tableData=t.data.rows,e.tablePage.total=t.data.totals},editRow(t){e.dialogForm=JSON.parse(JSON.stringify(t)),e.showDialog=!0},deleteRow(t){g.$dialog({content:n.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(t.id){const{data:s}=await z(t.id);if(!s.isSuccess){g.$message({type:"error",content:s.errorMessage});return}g.$message({type:"success",content:`${n.global.t("system.page.delete")}${n.global.t("system.tips.success")}`}),o.refresh()}}})},handlePageChange:c(({currentPage:t,pageSize:s})=>{e.tablePage.pageIndex=t,e.tablePage.pageSize=s,o.getWarehouseList()}),exportTable:()=>{const t=w.value;H({table:t,filename:n.global.t("base.warehouseSetting.warehouseSetting"),columnFilterMethod({column:s}){return!["checkbox"].includes(s==null?void 0:s.type)&&!["operate"].includes(s==null?void 0:s.field)}})},sureSearch:()=>{e.tablePage.searchObjects=U(e.searchForm),o.getWarehouseList()}});R(()=>{e.btnList=[{name:n.global.t("system.page.add"),icon:"mdi-plus",code:"warehouse-save",click:o.add},{name:n.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:o.refresh},{name:n.global.t("system.page.import"),icon:"mdi-database-import-outline",code:"warehouse-import",click:o.openDialogImport},{name:n.global.t("system.page.export"),icon:"mdi-export-variant",code:"warehouse-export",click:o.exportTable}]});const D=S(()=>L({})),$=S(()=>P({}));return j(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,o.sureSearch()},k)},{deep:!0}),v({getWarehouseList:o.getWarehouseList}),(t,s)=>{const d=u("v-col"),p=u("v-text-field"),_=u("v-row"),l=u("vxe-column"),I=u("vxe-table");return K(),q(Y,null,[b("div",X,[a(_,{"no-gutters":""},{default:i(()=>[a(d,{cols:"3",class:"col"},{default:i(()=>[a(N,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),a(d,{cols:"9"},{default:i(()=>[a(_,{"no-gutters":"",onKeyup:C(o.sureSearch,["enter"])},{default:i(()=>[a(d,{cols:"4"},{default:i(()=>[a(p,{modelValue:e.searchForm.warehouse_name,"onUpdate:modelValue":s[0]||(s[0]=r=>e.searchForm.warehouse_name=r),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("base.warehouseSetting.warehouse_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),a(d,{cols:"4"},{default:i(()=>[a(p,{modelValue:e.searchForm.city,"onUpdate:modelValue":s[1]||(s[1]=r=>e.searchForm.city=r),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("base.warehouseSetting.city"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),a(d,{cols:"4"},{default:i(()=>[a(p,{modelValue:e.searchForm.manager,"onUpdate:modelValue":s[2]||(s[2]=r=>e.searchForm.manager=r),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("base.warehouseSetting.manager"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),b("div",{class:"mt-5",style:Z({height:m(D)})},[a(I,{ref_key:"xTableWarehouse",ref:w,"column-config":{minWidth:"100px"},data:e.tableData,height:m($),align:"center"},{default:i(()=>[a(l,{type:"seq",width:"60"}),a(l,{type:"checkbox",width:"50"}),a(l,{field:"warehouse_name",title:t.$t("base.warehouseSetting.warehouse_name")},null,8,["title"]),a(l,{field:"city",title:t.$t("base.warehouseSetting.city")},null,8,["title"]),a(l,{field:"address",title:t.$t("base.warehouseSetting.address")},null,8,["title"]),a(l,{field:"contact_tel",title:t.$t("base.warehouseSetting.contact_tel")},null,8,["title"]),a(l,{field:"email",title:t.$t("base.warehouseSetting.email")},null,8,["title"]),a(l,{field:"manager",title:t.$t("base.warehouseSetting.manager")},null,8,["title"]),a(l,{field:"creator",title:t.$t("base.warehouseSetting.creator")},null,8,["title"]),a(l,{field:"create_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:t.$t("base.warehouseSetting.create_time")},null,8,["title"]),a(l,{field:"is_valid",title:t.$t("base.warehouseSetting.is_valid")},{default:i(({row:r,column:h})=>[b("span",null,J(m(O)(r[h.property])),1)]),_:1},8,["title"]),a(l,{field:"operate",title:t.$t("system.page.operate"),width:"160",resizable:!1,"show-overflow":""},{default:i(({row:r})=>[a(y,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":t.$t("system.page.edit"),disabled:!e.authorityList.includes("warehouse-save"),onClick:h=>o.editRow(r)},null,8,["tooltip-text","disabled","onClick"]),a(y,{flat:!0,icon:"mdi-delete-outline","tooltip-text":t.$t("system.page.delete"),"icon-color":e.authorityList.includes("warehouse-delete")?m(x):"",disabled:!e.authorityList.includes("warehouse-delete"),onClick:h=>o.deleteRow(r)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),a(W,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":m(T),layouts:m(V),onPageChange:o.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4),a(M,{"show-dialog":e.showDialog,form:e.dialogForm,onClose:o.closeDialog,onSaveSuccess:o.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"]),a(B,{"show-dialog":e.showDialogImport,onClose:o.closeDialogImport,onSaveSuccess:o.saveSuccessImport},null,8,["show-dialog","onClose","onSaveSuccess"])],64)}}});const ve=Q(ee,[["__scopeId","data-v-c57f122e"]]);export{ve as default};
