import{i as t}from"./i18n-0af8b262.js";import{a as _}from"./index-cd6d6b34.js";import{a as F,d as N,e as R}from"./warehouseSetting-835f9e1c.js";import{A as n}from"./Warehouse-56a6b193.js";import{S as h}from"./formRule-3feb276f.js";import{r as B}from"./common-938b41ea.js";import{d as I,b as p,c as w,r as y,w as O,a as l,x as j,v as q,s as i,q as r,y as S,at as $,ap as L,ac as M}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-e1053d5a.js";import"./index-f4e4efab.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";const z=I({__name:"add-or-update-reservoir",props:{showDialog:{type:Boolean},form:null},emits:["close","saveSuccess"],setup(k,{emit:b}){const c=k,v=p(),d=w(()=>c.showDialog),x=w(()=>c.form.id&&c.form.id>0?"update":"add"),a=y({form:p({id:0,warehouse_id:0,parent_id:0,warehouse_name:"",area_name:"",area_property:n.picking_area,is_valid:!0}),rules:{warehouse_name:[e=>!!e||`${t.global.t("system.checkText.mustInput")}${t.global.t("base.warehouseSetting.warehouse_name")}!`],area_name:[e=>!!e||`${t.global.t("system.checkText.mustInput")}${t.global.t("base.warehouseSetting.area_name")}!`,e=>h(e,0,32)===""||h(e,0,32)],area_property:[e=>!!e||`${t.global.t("system.checkText.mustInput")}${t.global.t("base.warehouseSetting.area_property")}!`],is_valid:[]},combobox:p({warehouse_name:[],area_property:[{label:t.global.t("base.warehouseSetting.picking_area"),value:n.picking_area},{label:t.global.t("base.warehouseSetting.stocking_area"),value:n.stocking_area},{label:t.global.t("base.warehouseSetting.receiving_area"),value:n.receiving_area},{label:t.global.t("base.warehouseSetting.return_area"),value:n.return_area},{label:t.global.t("base.warehouseSetting.defective_area"),value:n.defective_area},{label:t.global.t("base.warehouseSetting.inventory_area"),value:n.inventory_area}]})}),m=y({getCombobox:async()=>{a.combobox.warehouse_name=[];const{data:e}=await F();if(!!e.isSuccess)for(const o of e.data)a.combobox.warehouse_name.push({label:o.name,value:Number(o.value)})},closeDialog:()=>{b("close")},initForm:()=>{a.form=c.form},changeWarehouse:e=>{const o=a.combobox.warehouse_name.find(u=>u.value===e);o&&(a.form.warehouse_name=o.label,a.form.warehouse_id=e)},submit:async()=>{const{valid:e}=await v.value.validate();if(e){const o=B(a.form),{data:u}=x.value==="add"?await N(o):await R(o);if(!u.isSuccess){_.$message({type:"error",content:u.errorMessage});return}_.$message({type:"success",content:`${t.global.t("system.page.submit")}${t.global.t("system.tips.success")}`}),b("saveSuccess")}else _.$message({type:"error",content:t.global.t("system.checkText.checkFormFail")})}});return O(()=>d.value,e=>{e&&(m.initForm(),m.getCombobox())}),(e,o)=>{const u=l("v-toolbar"),f=l("v-select"),V=l("v-text-field"),C=l("v-switch"),U=l("v-form"),T=l("v-card-text"),g=l("v-btn"),D=l("v-card-actions"),W=l("v-card"),A=l("v-dialog");return j(),q(A,{modelValue:L(d),"onUpdate:modelValue":o[4]||(o[4]=s=>M(d)?d.value=s:null),width:"30%",transition:"dialog-top-transition",persistent:!0},{default:i(()=>[r(W,null,{default:i(()=>[r(u,{color:"white",title:`${e.$t("base.warehouseSetting.reservoirSetting")}`},null,8,["title"]),r(T,null,{default:i(()=>[r(U,{ref_key:"formRef",ref:v},{default:i(()=>[r(f,{modelValue:a.form.warehouse_id,"onUpdate:modelValue":[o[0]||(o[0]=s=>a.form.warehouse_id=s),m.changeWarehouse],items:a.combobox.warehouse_name,"item-title":"label","item-value":"value",rules:a.rules.warehouse_name,label:e.$t("base.warehouseSetting.warehouse_name"),variant:"outlined",clearable:""},null,8,["modelValue","items","rules","label","onUpdate:modelValue"]),r(V,{modelValue:a.form.area_name,"onUpdate:modelValue":o[1]||(o[1]=s=>a.form.area_name=s),label:e.$t("base.warehouseSetting.area_name"),rules:a.rules.area_name,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),r(f,{modelValue:a.form.area_property,"onUpdate:modelValue":o[2]||(o[2]=s=>a.form.area_property=s),items:a.combobox.area_property,"item-title":"label","item-value":"value",rules:a.rules.area_property,label:e.$t("base.warehouseSetting.area_property"),variant:"outlined",clearable:""},null,8,["modelValue","items","rules","label"]),r(C,{modelValue:a.form.is_valid,"onUpdate:modelValue":o[3]||(o[3]=s=>a.form.is_valid=s),color:"primary",label:e.$t("base.warehouseSetting.is_valid"),rules:a.rules.is_valid},null,8,["modelValue","label","rules"])]),_:1},512)]),_:1}),r(D,{class:"justify-end"},{default:i(()=>[r(g,{variant:"text",onClick:m.closeDialog},{default:i(()=>[S($(e.$t("system.page.close")),1)]),_:1},8,["onClick"]),r(g,{color:"primary",variant:"text",onClick:m.submit},{default:i(()=>[S($(e.$t("system.page.submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const re=P(z,[["__scopeId","data-v-2ae0657c"]]);export{re as default};
