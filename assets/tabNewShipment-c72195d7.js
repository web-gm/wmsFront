import{i as h,w as x}from"./i18n-0af8b262.js";import{a as $,b as P}from"./style-b9bc59b4.js";import{D as N,a as C,c as T,P as E,b as F}from"./system-93ae242b.js";import{a as k}from"./index-cd6d6b34.js";import{i as z}from"./deliveryManagement-7eebd823.js";import{_ as I}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import{G as w}from"./commodityManagement-a1debff9.js";import{g as V,s as L}from"./common-938b41ea.js";import{e as A}from"./exportTable-b0d17537.js";import{_ as B}from"./search-delivered-main-detail.vue_vue_type_script_setup_true_lang-4c46cac7.js";import{B as G}from"./btnGroup-26ff2079.js";import{d as O,b as d,r as b,o as U,c as v,w as j,a as c,x as q,m as H,u as p,q as a,s,y as K,at as u,ap as r,as as R,O as Z}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";const Y={class:"operateArea"},J={style:{width:"100%",display:"flex","justify-content":"center"}},Q=O({__name:"tabNewShipment",setup(X,{expose:y}){const g=d(),e=b({showDeliveredMainDetailNo:"",showDeliveredMainDetail:!1,showDialog:!1,searchForm:{dispatch_no:"",customer_name:""},timer:d(null),activeTab:null,tableData:d([]),tablePage:d({total:0,pageIndex:1,pageSize:N,searchObjects:[]}),btnList:[],authorityList:V()}),l=b({viewRow:t=>{t.dispatch_no&&(e.showDeliveredMainDetailNo=t.dispatch_no,e.showDeliveredMainDetail=!0)},closeDeliveredDetail:()=>{e.showDeliveredMainDetail=!1},refresh:()=>{l.getNewShipment()},getNewShipment:async()=>{const{data:t}=await z(e.tablePage);if(!t.isSuccess){k.$message({type:"error",content:t.errorMessage});return}e.tableData=t.data.rows,e.tablePage.total=t.data.totals},handlePageChange:d(({currentPage:t,pageSize:o})=>{e.tablePage.pageIndex=t,e.tablePage.pageSize=o,l.getNewShipment()}),exportTable:()=>{const t=g.value;A({table:t,filename:h.global.t("wms.deliveryManagement.newShipment"),columnFilterMethod({column:o}){return!["checkbox"].includes(o==null?void 0:o.type)&&!["operate"].includes(o==null?void 0:o.field)}})},sureSearch:()=>{e.tablePage.searchObjects=L(e.searchForm),l.getNewShipment()}});U(()=>{e.btnList=[{name:h.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:l.refresh},{name:h.global.t("system.page.export"),icon:"mdi-export-variant",code:"invoice-export",click:l.exportTable}]});const D=v(()=>$({})),S=v(()=>P({}));return j(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,l.sureSearch()},C)},{deep:!0}),y({getNewShipment:l.getNewShipment}),(t,o)=>{const m=c("v-col"),f=c("v-text-field"),_=c("v-row"),n=c("vxe-column"),M=c("vxe-table");return q(),H(Z,null,[p("div",Y,[a(_,{"no-gutters":""},{default:s(()=>[a(m,{cols:"3",class:"col"},{default:s(()=>[a(G,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),a(m,{cols:"9"},{default:s(()=>[a(_,{"no-gutters":"",onKeyup:x(l.sureSearch,["enter"])},{default:s(()=>[a(m,{cols:"4"}),a(m,{cols:"4"},{default:s(()=>[a(f,{modelValue:e.searchForm.dispatch_no,"onUpdate:modelValue":o[0]||(o[0]=i=>e.searchForm.dispatch_no=i),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.deliveryManagement.dispatch_no"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),a(m,{cols:"4"},{default:s(()=>[a(f,{modelValue:e.searchForm.customer_name,"onUpdate:modelValue":o[1]||(o[1]=i=>e.searchForm.customer_name=i),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:t.$t("wms.deliveryManagement.customer_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),p("div",{class:"mt-5",style:R({height:r(D)})},[a(M,{ref_key:"xTable",ref:g,"column-config":{minWidth:"100px"},data:e.tableData,height:r(S),align:"center"},{empty:s(()=>[K(u(r(h).global.t("system.page.noData")),1)]),default:s(()=>[a(n,{type:"seq",width:"60"}),a(n,{field:"dispatch_no",title:t.$t("wms.deliveryManagement.dispatch_no")},null,8,["title"]),a(n,{field:"qty",title:t.$t("wms.deliveryManagement.qty")},null,8,["title"]),a(n,{field:"weight",title:t.$t("wms.deliveryManagement.weight")},{default:s(({row:i})=>[p("span",null,u(`${i.weight} ${r(w)("weight",2)}`),1)]),_:1},8,["title"]),a(n,{field:"volume",title:t.$t("wms.deliveryManagement.volume")},{default:s(({row:i})=>[p("span",null,u(`${i.volume} ${r(w)("volume",1)}`),1)]),_:1},8,["title"]),a(n,{field:"customer_name",title:t.$t("wms.deliveryManagement.customer_name")},null,8,["title"]),a(n,{field:"creator",title:t.$t("wms.deliveryManagement.creator")},null,8,["title"]),a(n,{field:"operate",title:t.$t("system.page.operate"),width:"60",resizable:!1,"show-overflow":""},{default:s(({row:i})=>[p("div",J,[a(I,{flat:!0,icon:"mdi-eye-outline","tooltip-text":t.$t("system.page.view"),onClick:ee=>l.viewRow(i)},null,8,["tooltip-text","onClick"])])]),_:1},8,["title"])]),_:1},8,["data","height"]),a(T,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":r(E),layouts:r(F),onPageChange:l.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"]),a(B,{"dispatch-no":e.showDeliveredMainDetailNo,"show-dialog":e.showDeliveredMainDetail,onClose:l.closeDeliveredDetail},null,8,["dispatch-no","show-dialog","onClose"])],4)],64)}}});const be=W(Q,[["__scopeId","data-v-ce873f68"]]);export{be as default};
