import{i as r,w as I}from"./i18n-0af8b262.js";import{a as P,b as k,e as T}from"./style-b9bc59b4.js";import{D as F,a as L,c as M,P as E,b as z}from"./system-93ae242b.js";import{_}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import O from"./add-or-update-supplier-e973abb5.js";import{a as m}from"./index-cd6d6b34.js";import{g as H,s as A}from"./common-938b41ea.js";import{d as B,b as N}from"./supplier-8eff24fc.js";import V from"./import-supplier-table-1a81f21a.js";import{e as U}from"./exportTable-b0d17537.js";import{B as G}from"./btnGroup-26ff2079.js";import{d as R,b as u,r as b,o as j,c as y,w as K,a as n,x as q,m as J,u as g,q as t,s as i,as as Z,ap as p,y as W,at as Y,O as Q}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";const ee={class:"container"},te={class:"operateArea"},ae=R({__name:"supplier",setup(se){const f=u(),e=b({searchForm:{supplier_name:""},tableData:[],showDialog:!1,showDialogImport:!1,dialogForm:{id:0,supplier_name:"",city:"",address:"",manager:"",email:"",contact_tel:"",is_valid:!0},tablePage:{total:0,pageIndex:1,pageSize:F,searchObjects:u([])},timer:u(null),btnList:[],authorityList:H()}),s=b({openDialogImport:()=>{e.showDialogImport=!0},closeDialogImport:()=>{e.showDialogImport=!1},saveSuccessImport:()=>{s.refresh(),s.closeDialog()},sureSearch:()=>{e.tablePage.searchObjects=A(e.searchForm),s.getData()},add:()=>{e.dialogForm={id:0,supplier_name:"",city:"",address:"",manager:"",email:"",contact_tel:"",is_valid:!0},e.showDialog=!0},closeDialog:()=>{e.showDialog=!1},saveSuccess:()=>{s.refresh(),s.closeDialog()},refresh:()=>{s.getData()},editRow(a){e.dialogForm=JSON.parse(JSON.stringify(a)),e.showDialog=!0},deleteRow(a){m.$dialog({content:r.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(a.id){const{data:o}=await B(a.id);if(!o.isSuccess){m.$message({type:"error",content:o.errorMessage});return}m.$message({type:"success",content:`${r.global.t("system.page.delete")}${r.global.t("system.tips.success")}`}),s.refresh()}}})},handlePageChange:u(({currentPage:a,pageSize:o})=>{e.tablePage.pageIndex=a,e.tablePage.pageSize=o,s.getData()}),exportTable:()=>{const a=f.value;U({table:a,filename:r.global.t("router.sideBar.supplier"),columnFilterMethod({column:o}){return!["checkbox"].includes(o==null?void 0:o.type)&&!["operate"].includes(o==null?void 0:o.field)}})},getData:async()=>{const{data:a}=await N(e.tablePage);if(!a.isSuccess){m.$message({type:"error",content:a.errorMessage});return}e.tableData=a.data.rows,e.tablePage.total=a.data.totals}});j(()=>{e.btnList=[{name:r.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:s.add},{name:r.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:s.refresh},{name:r.global.t("system.page.import"),icon:"mdi-database-import-outline",code:"import",click:s.openDialogImport},{name:r.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:s.exportTable}],s.getData()});const v=y(()=>P({hasTab:!1})),D=y(()=>k({hasTab:!1}));return K(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,s.sureSearch()},L)},{deep:!0}),(a,o)=>{const c=n("v-col"),w=n("v-text-field"),h=n("v-row"),l=n("vxe-column"),S=n("vxe-table"),$=n("v-card-text"),x=n("v-card");return q(),J(Q,null,[g("div",ee,[g("div",null,[t(x,{class:"mt-5"},{default:i(()=>[t($,null,{default:i(()=>[g("div",te,[t(h,{"no-gutters":""},{default:i(()=>[t(c,{cols:"12",sm:"4",class:"col"},{default:i(()=>[t(G,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),t(c,{cols:"12",sm:"8"},{default:i(()=>[t(h,{"no-gutters":"",onKeyup:I(s.sureSearch,["enter"])},{default:i(()=>[t(c,{cols:"12",sm:"4"}),t(c,{cols:"12",sm:"4"}),t(c,{cols:"12",sm:"4"},{default:i(()=>[t(w,{modelValue:e.searchForm.supplier_name,"onUpdate:modelValue":o[0]||(o[0]=d=>e.searchForm.supplier_name=d),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:a.$t("base.supplier.supplier_name"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),g("div",{class:"mt-5",style:Z({height:p(v)})},[t(S,{ref_key:"xTable",ref:f,"column-config":{minWidth:"100px"},data:e.tableData,height:p(D),align:"center"},{empty:i(()=>[W(Y(p(r).global.t("system.page.noData")),1)]),default:i(()=>[t(l,{type:"seq",width:"60"}),t(l,{type:"checkbox",width:"50"}),t(l,{field:"supplier_name",title:a.$t("base.supplier.supplier_name")},null,8,["title"]),t(l,{field:"city",title:a.$t("base.supplier.city")},null,8,["title"]),t(l,{field:"address",title:a.$t("base.supplier.address")},null,8,["title"]),t(l,{field:"manager",title:a.$t("base.supplier.manager")},null,8,["title"]),t(l,{field:"email",title:a.$t("base.supplier.email")},null,8,["title"]),t(l,{field:"contact_tel",title:a.$t("base.supplier.contact_tel")},null,8,["title"]),t(l,{field:"creator",title:a.$t("base.supplier.creator")},null,8,["title"]),t(l,{field:"create_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:a.$t("base.supplier.create_time")},null,8,["title"]),t(l,{field:"last_update_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:a.$t("base.supplier.last_update_time")},null,8,["title"]),t(l,{field:"operate",title:a.$t("system.page.operate"),width:"160",resizable:!1,"show-overflow":""},{default:i(({row:d})=>[t(_,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":a.$t("system.page.edit"),disabled:!e.authorityList.includes("save"),onClick:C=>s.editRow(d)},null,8,["tooltip-text","disabled","onClick"]),t(_,{flat:!0,icon:"mdi-delete-outline","tooltip-text":a.$t("system.page.delete"),"icon-color":e.authorityList.includes("delete")?p(T):"",disabled:!e.authorityList.includes("delete"),onClick:C=>s.deleteRow(d)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),t(M,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":p(E),layouts:p(z),onPageChange:s.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)]),_:1})]),_:1})])]),t(O,{"show-dialog":e.showDialog,form:e.dialogForm,onClose:s.closeDialog,onSaveSuccess:s.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"]),t(V,{"show-dialog":e.showDialogImport,onClose:s.closeDialogImport,onSaveSuccess:s.saveSuccessImport},null,8,["show-dialog","onClose","onSaveSuccess"])],64)}}});const we=X(ae,[["__scopeId","data-v-e721a7f8"]]);export{we as default};
