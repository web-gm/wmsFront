import{a as p}from"./index-cd6d6b34.js";import{a as L,b as B,c as O,u as R}from"./warehouseSetting-835f9e1c.js";import{A as b}from"./Warehouse-56a6b193.js";import{i as r}from"./i18n-0af8b262.js";import{S as n,a as m}from"./formRule-3feb276f.js";import{r as j}from"./common-938b41ea.js";import{d as D,b as h,c as y,r as S,w as G,a as d,x as q,v as M,s as _,q as t,y as $,at as U,ap as P,ac as z}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-e1053d5a.js";import"./index-f4e4efab.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";const H=D({__name:"add-or-update-location",props:{showDialog:{type:Boolean},form:null},emits:["close","saveSuccess"],setup(k,{emit:v}){const c=k,w=h(),g=y(()=>c.showDialog),N=y(()=>c.form.id&&c.form.id>0?"update":"add"),a=S({form:h({id:0,warehouse_name:"",warehouse_area_name:"",location_name:"",location_length:0,location_width:0,location_heigth:0,location_volume:0,location_load:0,roadway_number:"",shelf_number:"",layer_number:"",tag_number:"",is_valid:!0}),rules:{warehouse_name:[e=>!!e||`${r.global.t("system.checkText.mustInput")}${r.global.t("base.warehouseSetting.warehouse_name")}!`,e=>n(e,0,32)===""||n(e,0,32)],warehouse_area_name:[e=>!!e||`${r.global.t("system.checkText.mustInput")}${r.global.t("base.warehouseSetting.area_name")}!`,e=>n(e,0,32)===""||n(e,0,32)],warehouse_area_property:[],location_name:[e=>!!e||`${r.global.t("system.checkText.mustInput")}${r.global.t("base.warehouseSetting.location_name")}!`,e=>n(e,0,64)===""||n(e,0,64)],location_length:[e=>m(e,"nonNegative",5,2)===""||m(e,"nonNegative",5,2)],location_width:[e=>m(e,"nonNegative",5,2)===""||m(e,"nonNegative",5,2)],location_heigth:[e=>m(e,"nonNegative",5,2)===""||m(e,"nonNegative",5,2)],location_volume:[e=>m(e,"nonNegative",12,2)===""||m(e,"nonNegative",12,2)],location_load:[e=>m(e,"nonNegative",8,2)===""||m(e,"nonNegative",8,2)],roadway_number:[e=>n(e,0,10)===""||n(e,0,10)],shelf_number:[e=>n(e,0,10)===""||n(e,0,10)],layer_number:[e=>n(e,0,10)===""||n(e,0,10)],tag_number:[e=>n(e,0,10)===""||n(e,0,10)],is_valid:[]},combobox:h({warehouse_name:[],warehouse_area_name:[],area_property:[{label:r.global.t("base.warehouseSetting.picking_area"),value:b.picking_area},{label:r.global.t("base.warehouseSetting.stocking_area"),value:b.stocking_area},{label:r.global.t("base.warehouseSetting.receiving_area"),value:b.receiving_area},{label:r.global.t("base.warehouseSetting.return_area"),value:b.return_area},{label:r.global.t("base.warehouseSetting.defective_area"),value:b.defective_area},{label:r.global.t("base.warehouseSetting.inventory_area"),value:b.inventory_area}]})}),u=S({changeWarehouse:e=>{if(a.combobox.warehouse_area_name=[],!e){u.initWarehouseArea();return}const o=a.combobox.warehouse_name.find(s=>s.value===e);o&&(a.form.warehouse_name=o.label,a.form.warehouse_id=e,u.initWarehouseArea(),u.getWarehouseAreaSelect(e))},changeWarehouseArea:e=>{if(!e){u.initWarehouseArea();return}const o=a.combobox.warehouse_area_name.find(s=>s.value===e);o&&(a.form.warehouse_area_name=o.label,a.form.warehouse_area_id=e,a.form.warehouse_area_property=o.meta)},initWarehouseArea(){delete a.form.warehouse_area_id,a.form.warehouse_area_name="",delete a.form.warehouse_area_property},getWarehouseSelect:async()=>{a.combobox.warehouse_name=[];const{data:e}=await L();if(!!e.isSuccess)for(const o of e.data)a.combobox.warehouse_name.push({label:o.name,value:Number(o.value)})},getWarehouseAreaSelect:async e=>{a.combobox.warehouse_area_name=[];const{data:o}=await B(e);if(!!o.isSuccess)for(const s of o.data)a.combobox.warehouse_area_name.push({label:s.area_name,value:s.id,meta:s.area_property})},closeDialog:()=>{v("close")},initForm:()=>{a.form=c.form},submit:async()=>{const{valid:e}=await w.value.validate();if(e){const o=j(a.form),{data:s}=N.value==="add"?await O(o):await R(o);if(!s.isSuccess){p.$message({type:"error",content:s.errorMessage});return}p.$message({type:"success",content:`${r.global.t("system.page.submit")}${r.global.t("system.tips.success")}`}),v("saveSuccess")}else p.$message({type:"error",content:r.global.t("system.checkText.checkFormFail")})}});return G(()=>g.value,e=>{e&&(u.initForm(),u.getWarehouseSelect())}),(e,o)=>{const s=d("v-toolbar"),f=d("v-select"),i=d("v-text-field"),W=d("v-switch"),x=d("v-form"),A=d("v-card-text"),V=d("v-btn"),C=d("v-card-actions"),T=d("v-card"),F=d("v-dialog");return q(),M(F,{modelValue:P(g),"onUpdate:modelValue":o[14]||(o[14]=l=>z(g)?g.value=l:null),width:"30%",transition:"dialog-top-transition",persistent:!0},{default:_(()=>[t(T,null,{default:_(()=>[t(s,{color:"white",title:`${e.$t("base.warehouseSetting.locationSetting")}`},null,8,["title"]),t(A,null,{default:_(()=>[t(x,{ref_key:"formRef",ref:w},{default:_(()=>[t(f,{modelValue:a.form.warehouse_id,"onUpdate:modelValue":[o[0]||(o[0]=l=>a.form.warehouse_id=l),u.changeWarehouse],items:a.combobox.warehouse_name,"item-title":"label","item-value":"value",rules:a.rules.warehouse_name,label:e.$t("base.warehouseSetting.warehouse_name"),variant:"outlined",clearable:""},null,8,["modelValue","items","rules","label","onUpdate:modelValue"]),t(f,{modelValue:a.form.warehouse_area_id,"onUpdate:modelValue":[o[1]||(o[1]=l=>a.form.warehouse_area_id=l),u.changeWarehouseArea],items:a.combobox.warehouse_area_name,"item-title":"label","item-value":"value",rules:a.rules.warehouse_area_name,label:e.$t("base.warehouseSetting.area_name"),variant:"outlined",clearable:""},null,8,["modelValue","items","rules","label","onUpdate:modelValue"]),t(f,{modelValue:a.form.warehouse_area_property,"onUpdate:modelValue":o[2]||(o[2]=l=>a.form.warehouse_area_property=l),items:a.combobox.area_property,"item-title":"label","item-value":"value",rules:a.rules.warehouse_area_property,label:e.$t("base.warehouseSetting.area_property"),variant:"outlined",disabled:"",clearable:""},null,8,["modelValue","items","rules","label"]),t(i,{modelValue:a.form.location_name,"onUpdate:modelValue":o[3]||(o[3]=l=>a.form.location_name=l),label:e.$t("base.warehouseSetting.location_name"),rules:a.rules.location_name,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.location_length,"onUpdate:modelValue":o[4]||(o[4]=l=>a.form.location_length=l),label:e.$t("base.warehouseSetting.location_length"),rules:a.rules.location_length,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.location_width,"onUpdate:modelValue":o[5]||(o[5]=l=>a.form.location_width=l),label:e.$t("base.warehouseSetting.location_width"),rules:a.rules.location_width,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.location_heigth,"onUpdate:modelValue":o[6]||(o[6]=l=>a.form.location_heigth=l),label:e.$t("base.warehouseSetting.location_heigth"),rules:a.rules.location_heigth,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.location_volume,"onUpdate:modelValue":o[7]||(o[7]=l=>a.form.location_volume=l),label:e.$t("base.warehouseSetting.location_volume"),rules:a.rules.location_volume,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.location_load,"onUpdate:modelValue":o[8]||(o[8]=l=>a.form.location_load=l),label:e.$t("base.warehouseSetting.location_load"),rules:a.rules.location_load,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.roadway_number,"onUpdate:modelValue":o[9]||(o[9]=l=>a.form.roadway_number=l),label:e.$t("base.warehouseSetting.roadway_number"),rules:a.rules.roadway_number,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.shelf_number,"onUpdate:modelValue":o[10]||(o[10]=l=>a.form.shelf_number=l),label:e.$t("base.warehouseSetting.shelf_number"),rules:a.rules.shelf_number,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.layer_number,"onUpdate:modelValue":o[11]||(o[11]=l=>a.form.layer_number=l),label:e.$t("base.warehouseSetting.layer_number"),rules:a.rules.layer_number,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(i,{modelValue:a.form.tag_number,"onUpdate:modelValue":o[12]||(o[12]=l=>a.form.tag_number=l),label:e.$t("base.warehouseSetting.tag_number"),rules:a.rules.tag_number,variant:"outlined",clearable:""},null,8,["modelValue","label","rules"]),t(W,{modelValue:a.form.is_valid,"onUpdate:modelValue":o[13]||(o[13]=l=>a.form.is_valid=l),color:"primary",label:e.$t("base.warehouseSetting.is_valid"),rules:a.rules.is_valid},null,8,["modelValue","label","rules"])]),_:1},512)]),_:1}),t(C,{class:"justify-end"},{default:_(()=>[t(V,{variant:"text",onClick:u.closeDialog},{default:_(()=>[$(U(e.$t("system.page.close")),1)]),_:1},8,["onClick"]),t(V,{color:"primary",variant:"text",onClick:u.submit},{default:_(()=>[$(U(e.$t("system.page.submit")),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});const ne=E(H,[["__scopeId","data-v-7fd0d56a"]]);export{ne as default};
