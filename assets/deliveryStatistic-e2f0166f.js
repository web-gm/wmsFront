import{a as E,b as F}from"./style-b9bc59b4.js";import{D as M,a as V,c as z,P as A,b as B}from"./system-93ae242b.js";import{g as I}from"./common-938b41ea.js";import{i as n}from"./i18n-0af8b262.js";import{e as L}from"./exportTable-b0d17537.js";import{B as G}from"./btnGroup-26ff2079.js";import{h as H}from"./request-e1053d5a.js";import{a as U}from"./index-cd6d6b34.js";import{_ as q}from"./search-group.vue_vue_type_script_setup_true_lang-77ccf260.js";import N from"./Chart-31f37ca7.js";import{d as O,b as m,r as p,o as j,c as _,w as Z,a as o,x as h,m as f,u as S,q as t,s as l,ap as c,as as w,y as W,at as Y}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./index-ae8f073f.js";import"./vue-router-1283ad2d.js";import"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import"./index-827f2091.js";import"./index-f9a914d4.js";import"./lodash-b35d7d50.js";const K=g=>H({url:"/stock/delivery-list",method:"post",data:g}),Q={class:"container"},X={class:"operateArea"},ee=O({__name:"deliveryStatistic",setup(g){const y=m(),v=m(),e=p({showDialog:!1,timer:m(null),activeTab:null,searchForm:{spu_code:"",spu_name:"",sku_code:"",sku_name:"",warehouse_name:"",customer_name:"",delivery_date_from:"",delivery_date_to:""},tableData:m([]),tablePage:p({total:0,pageIndex:1,pageSize:M,searchObjects:m([])}),btnList:[],authorityList:I(),menu_name:"deliveryStatistic",currentRender:"table"}),i=p({switchRenderMode:()=>{e.currentRender==="chart"?e.currentRender="table":e.currentRender="chart"},list:async()=>{const a={};for(const d of Object.keys(e.searchForm))e.searchForm[d]&&(a[d]=e.searchForm[d]);const{data:r}=await K({...e.tablePage,...a});if(!r.isSuccess){U.$message({type:"error",content:r.errorMessage});return}e.tableData=r.data.rows,e.tablePage.total=r.data.totals},refresh:()=>{i.list()},closeDialog:()=>{e.showDialog=!1},handlePageChange:m(({currentPage:a,pageSize:r})=>{e.tablePage.pageIndex=a,e.tablePage.pageSize=r,i.refresh()}),exportTable:()=>{const a=y.value;L({table:a,filename:n.global.t("router.sideBar.deliveryStatistic"),columnFilterMethod({column:r}){return!["checkbox"].includes(r==null?void 0:r.type)&&!["operate"].includes(r==null?void 0:r.field)}})},sureSearch:()=>{i.refresh()},handleSetSearch:()=>{v.value.openDialog()}});j(()=>{});const b=_(()=>E({hasTab:!1})),k=_(()=>F({hasTab:!1})),x=_(()=>[{name:n.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:i.refresh},{name:n.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:i.exportTable},{name:n.global.t("system.page.setSearch"),icon:"mdi-cog",code:"",click:i.handleSetSearch},{name:e.currentRender!=="chart"?n.global.t("system.page.chart"):n.global.t("system.page.table"),icon:e.currentRender!=="chart"?"mdi-chart-bar":"mdi-table",code:"",click:i.switchRenderMode}]);return Z(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,i.sureSearch()},V)},{deep:!0}),(a,r)=>{const d=o("v-col"),P=o("v-row"),s=o("vxe-column"),T=o("vxe-table"),D=o("v-window-item"),$=o("v-window"),C=o("v-card-text"),R=o("v-card");return h(),f("div",Q,[S("div",null,[t(R,{class:"mt-5"},{default:l(()=>[t(C,null,{default:l(()=>[t($,{modelValue:e.activeTab,"onUpdate:modelValue":r[1]||(r[1]=u=>e.activeTab=u)},{default:l(()=>[t(D,null,{default:l(()=>[S("div",X,[t(P,{"no-gutters":""},{default:l(()=>[t(d,{cols:"3",class:"col"},{default:l(()=>[t(G,{"authority-list":e.authorityList,"btn-list":c(x)},null,8,["authority-list","btn-list"])]),_:1}),t(d,{cols:"9"},{default:l(()=>[t(q,{ref_key:"searchGroupRef",ref:v,modelValue:e.searchForm,"onUpdate:modelValue":r[0]||(r[0]=u=>e.searchForm=u),"menu-name":e.menu_name,"i18n-prefix":"wms.deliveryStatistic",onSureSearch:i.sureSearch},null,8,["modelValue","menu-name","onSureSearch"])]),_:1})]),_:1})]),e.currentRender==="table"?(h(),f("div",{key:0,class:"mt-5",style:w({height:c(b)})},[t(T,{ref_key:"xTable",ref:y,"column-config":{minWidth:"120px"},data:e.tableData,height:c(k),align:"center"},{empty:l(()=>[W(Y(c(n).global.t("system.page.noData")),1)]),default:l(()=>[t(s,{type:"seq",width:"60"}),t(s,{field:"dispatch_no",title:a.$t("wms.deliveryStatistic.dispatch_no")},null,8,["title"]),t(s,{field:"warehouse_name",title:a.$t("wms.deliveryStatistic.warehouse_name")},null,8,["title"]),t(s,{field:"location_name",title:a.$t("wms.deliveryStatistic.location_name")},null,8,["title"]),t(s,{field:"spu_code",title:a.$t("wms.deliveryStatistic.spu_code")},null,8,["title"]),t(s,{field:"spu_name",title:a.$t("wms.deliveryStatistic.spu_name")},null,8,["title"]),t(s,{field:"sku_code",title:a.$t("wms.deliveryStatistic.sku_code")},null,8,["title"]),t(s,{field:"sku_name",title:a.$t("wms.deliveryStatistic.sku_name")},null,8,["title"]),t(s,{field:"customer_name",title:a.$t("wms.deliveryStatistic.customer_name")},null,8,["title"]),t(s,{field:"series_number",title:a.$t("wms.deliveryStatistic.series_number")},null,8,["title"]),t(s,{field:"delivery_qty",title:a.$t("wms.deliveryStatistic.delivery_qty")},null,8,["title"]),t(s,{field:"delivery_date",title:a.$t("wms.deliveryStatistic.delivery_date"),width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"]},null,8,["title"])]),_:1},8,["data","height"]),t(z,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":c(A),layouts:c(B),onPageChange:i.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)):(h(),f("div",{key:1,class:"mt-5",style:w({height:c(b)})},[t(N,{type:"delivery","chart-data":e.tableData},null,8,["chart-data"])],4))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])])}}});const be=J(ee,[["__scopeId","data-v-3316ef33"]]);export{be as default};
