import{F as v,a as O}from"./warehouseWorking-497fd91f.js";import{a as b}from"./index-cd6d6b34.js";import{h as g}from"./request-e1053d5a.js";import{r as x}from"./common-938b41ea.js";import{c as B}from"./commodity-select-5da8c47a.js";import{i as s}from"./i18n-0af8b262.js";import{d as L,b as h,c,r as S,w as q,a as n,x as I,m as N,q as a,s as i,ap as f,y as C,at as V,ac as W,O as Z}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";const te=m=>g({url:"/stockfreeze/list",method:"post",data:m}),ae=m=>g({url:"/stockfreeze",method:"get",params:{id:m}}),P=m=>g({url:"/stockfreeze",method:"post",data:m}),A=L({__name:"add-or-update-freeze",props:{showDialog:{type:Boolean},form:null,freezeType:{type:Boolean}},emits:["close","saveSuccess"],setup(m,{emit:y}){const d=m,k=h(),F=c(()=>d.form.id&&d.form.id>0),$=c(()=>!!F.value),_=c(()=>d.showDialog),z=c(()=>e.form.job_type===v?s.global.t("base.roleMenu.operationTitle.stock")+s.global.t("wms.warehouseWorking.warehouseFreeze.freeze"):s.global.t("base.roleMenu.operationTitle.stock")+s.global.t("wms.warehouseWorking.warehouseFreeze.unfreeze")),D=c(()=>e.form.job_type===O?"frozen":""),e=S({showCommodityDialogSelect:!1,showLocationDialogSelect:!1,form:h({id:0,job_code:"",job_type:v,sku_id:0,goods_owner_id:0,goods_location_id:0,handler:"",handle_time:"",last_update_time:"",tenant_id:0,warehouse_name:"",location_name:"",spu_code:"",spu_name:"",sku_code:"",series_number:"",creator:"",create_time:""}),rules:{warehouse_name:[],location_name:[],spu_code:[o=>!!o||`${s.global.t("system.checkText.mustInput")}${s.global.t("base.commodityManagement.spu_code")}!`],spu_name:[o=>!!o||`${s.global.t("system.checkText.mustInput")}${s.global.t("base.commodityManagement.spu_name")}!`],sku_code:[o=>!!o||`${s.global.t("system.checkText.mustInput")}${s.global.t("base.commodityManagement.sku_code")}!`]}}),r=S({closeDialog:()=>{y("close")},initForm:()=>{e.form=d.form,e.form.job_type=d.freezeType},openCommoditySelect:()=>{setTimeout(()=>{e.showCommodityDialogSelect=!0},100)},closeCommodityDialogSelect:()=>{e.showCommodityDialogSelect=!1},openLocationSelect:()=>{setTimeout(()=>{e.showLocationDialogSelect=!0},100)},closeLocationDialogSelect:()=>{e.showLocationDialogSelect=!1},sureSelectCommodity:o=>{try{e.form.sku_id=o[0].sku_id,e.form.spu_code=o[0].spu_code,e.form.spu_name=o[0].spu_name,e.form.sku_code=o[0].sku_code,e.form.series_number=o[0].series_number,e.form.goods_owner_id=o[0].goods_owner_id,e.form.goods_location_id=o[0].goods_location_id,e.form.warehouse_name=o[0].warehouse_name,e.form.location_name=o[0].location_name}catch(t){console.error(t)}},clearCommodity:()=>{e.form.sku_id=0,e.form.spu_code="",e.form.spu_name="",e.form.sku_code=""},clearLocation:()=>{e.form.goods_location_id=0,e.form.warehouse_name="",e.form.location_name=""},submit:async()=>{const{valid:o}=await k.value.validate(),t=r.constructFormBody();if(o){const{data:p}=await P(t);if(!p.isSuccess){b.$message({type:"error",content:p.errorMessage});return}b.$message({type:"success",content:`${s.global.t("system.page.submit")}${s.global.t("system.tips.success")}`}),y("saveSuccess")}else b.$message({type:"error",content:s.global.t("system.checkText.checkFormFail")})},constructFormBody:()=>{let o={...e.form};return o=x(o),o}});return q(()=>_.value,o=>{o&&r.initForm()}),(o,t)=>{const p=n("v-toolbar"),u=n("v-text-field"),T=n("v-form"),E=n("v-card-text"),w=n("v-btn"),U=n("v-card-actions"),j=n("v-card"),M=n("v-dialog");return I(),N(Z,null,[a(M,{modelValue:f(_),"onUpdate:modelValue":t[6]||(t[6]=l=>W(_)?_.value=l:null),width:"30%",transition:"dialog-top-transition",persistent:!0},{default:i(()=>[a(j,null,{default:i(()=>[a(p,{class:"",color:"white",title:`${f(z)}`},null,8,["title"]),a(E,null,{default:i(()=>[a(T,{ref_key:"formRef",ref:k},{default:i(()=>[a(u,{modelValue:e.form.spu_code,"onUpdate:modelValue":t[0]||(t[0]=l=>e.form.spu_code=l),label:o.$t("base.commodityManagement.spu_code"),rules:e.rules.spu_code,variant:"outlined",readonly:"",clearable:"",onClick:r.openCommoditySelect,"onClick:clear":r.clearCommodity},null,8,["modelValue","label","rules","onClick","onClick:clear"]),a(u,{modelValue:e.form.spu_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.form.spu_name=l),label:o.$t("base.commodityManagement.spu_name"),rules:e.rules.spu_name,variant:"outlined",disabled:""},null,8,["modelValue","label","rules"]),a(u,{modelValue:e.form.sku_code,"onUpdate:modelValue":t[2]||(t[2]=l=>e.form.sku_code=l),label:o.$t("base.commodityManagement.sku_code"),rules:e.rules.sku_code,variant:"outlined",disabled:""},null,8,["modelValue","label","rules"]),a(u,{modelValue:e.form.series_number,"onUpdate:modelValue":t[3]||(t[3]=l=>e.form.series_number=l),label:o.$t("wms.stockLocation.series_number"),variant:"outlined",disabled:""},null,8,["modelValue","label"]),a(u,{modelValue:e.form.location_name,"onUpdate:modelValue":t[4]||(t[4]=l=>e.form.location_name=l),label:o.$t("wms.warehouseWorking.warehouseFreeze.location_name"),rules:e.rules.location_name,variant:"outlined",disabled:""},null,8,["modelValue","label","rules"]),a(u,{modelValue:e.form.warehouse_name,"onUpdate:modelValue":t[5]||(t[5]=l=>e.form.warehouse_name=l),label:o.$t("wms.warehouseWorking.warehouseFreeze.warehouse"),rules:e.rules.warehouse_name,variant:"outlined",disabled:""},null,8,["modelValue","label","rules"])]),_:1},512)]),_:1}),a(U,{class:"justify-end"},{default:i(()=>[a(w,{variant:"text",onClick:r.closeDialog},{default:i(()=>[C(V(o.$t("system.page.close")),1)]),_:1},8,["onClick"]),a(w,{color:"primary",variant:"text",disabled:f($),onClick:r.submit},{default:i(()=>[C(V(o.$t("system.page.submit")),1)]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{"show-dialog":e.showCommodityDialogSelect,"sql-title":f(D),onClose:r.closeCommodityDialogSelect,onSureSelect:r.sureSelectCommodity},null,8,["show-dialog","sql-title","onClose","onSureSelect"])],64)}}});const G=J(A,[["__scopeId","data-v-8a412de9"]]),le=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{ae as a,G as b,le as c,te as g};
