import{i as n,w as T}from"./i18n-0af8b262.js";import{a as L,b as V,e as k}from"./style-b9bc59b4.js";import{D as E,a as O,c as z,P as M,b as N}from"./system-93ae242b.js";import{a as g}from"./index-cd6d6b34.js";import{g as U,d as A}from"./freightSetting-4f9f7a61.js";import{g as B,s as H}from"./common-938b41ea.js";import{_ as v}from"./tooltip-btn.vue_vue_type_script_setup_true_lang-fc6ce76f.js";import G from"./add-or-update-freight-e32f7b20.js";import R from"./import-table-583e33dd.js";import{e as j}from"./exportTable-b0d17537.js";import{B as K}from"./btnGroup-26ff2079.js";import{d as q,b as p,r as b,o as J,c as w,w as Z,a as c,x as W,m as Y,u,q as t,s as l,as as Q,ap as d,y as X,at as S}from"./runtime-core.esm-bundler-1bbee395.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-f4e4efab.js";import"./request-e1053d5a.js";import"./index-827f2091.js";import"./vue-router-1283ad2d.js";import"./index-ae8f073f.js";import"./formRule-3feb276f.js";import"./formatSystem-1203ad16.js";const te={class:"container"},ae={class:"operateArea"},oe=q({__name:"freightSetting",setup(ie){const h=p(),e=b({showDialog:!1,showDialogImport:!1,dialogForm:{id:0,carrier:"",departure_city:"",arrival_city:"",price_per_weight:0,price_per_volume:0,min_payment:0,is_valid:!0},searchForm:{carrier:"",departure_city:"",arrival_city:""},activeTab:null,tableData:p([]),tablePage:b({total:0,pageIndex:1,pageSize:E,searchObjects:p([])}),timer:p(null),btnList:[],authorityList:B()}),o=b({add:()=>{e.dialogForm={id:0,carrier:"",departure_city:"",arrival_city:"",price_per_weight:0,price_per_volume:0,min_payment:0,is_valid:!0},e.showDialog=!0},closeDialog:()=>{e.showDialog=!1},saveSuccess:()=>{o.refresh(),o.closeDialog()},openDialogImport:()=>{e.showDialogImport=!0},closeDialogImport:()=>{e.showDialogImport=!1},saveSuccessImport:()=>{o.refresh(),o.closeDialogImport()},refresh:()=>{o.getFreightList()},getFreightList:async()=>{const{data:a}=await U(e.tablePage);if(!a.isSuccess){g.$message({type:"error",content:a.errorMessage});return}e.tableData=a.data.rows,e.tablePage.total=a.data.totals},editRow(a){e.dialogForm=JSON.parse(JSON.stringify(a)),e.showDialog=!0},deleteRow(a){g.$dialog({content:n.global.t("system.tips.beforeDeleteMessage"),handleConfirm:async()=>{if(a.id){const{data:i}=await A(a.id);if(!i.isSuccess){g.$message({type:"error",content:i.errorMessage});return}g.$message({type:"success",content:`${n.global.t("system.page.delete")}${n.global.t("system.tips.success")}`}),o.refresh()}}})},handlePageChange:p(({currentPage:a,pageSize:i})=>{e.tablePage.pageIndex=a,e.tablePage.pageSize=i,o.getFreightList()}),exportTable:()=>{const a=h.value;j({table:a,filename:n.global.t("router.sideBar.freightSetting"),columnFilterMethod({column:i}){return!["checkbox"].includes(i==null?void 0:i.type)&&!["operate"].includes(i==null?void 0:i.field)}})},importTable:()=>{h.value.importData()},sureSearch:()=>{e.tablePage.searchObjects=H(e.searchForm),o.getFreightList()}});J(()=>{e.btnList=[{name:n.global.t("system.page.add"),icon:"mdi-plus",code:"save",click:o.add},{name:n.global.t("system.page.refresh"),icon:"mdi-refresh",code:"",click:o.refresh},{name:n.global.t("system.page.import"),icon:"mdi-database-import-outline",code:"import",click:o.openDialogImport},{name:n.global.t("system.page.export"),icon:"mdi-export-variant",code:"export",click:o.exportTable}],o.getFreightList()});const D=w(()=>L({hasTab:!1})),$=w(()=>V({hasTab:!1}));return Z(()=>e.searchForm,()=>{e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{e.timer=null,o.sureSearch()},O)},{deep:!0}),(a,i)=>{const m=c("v-col"),f=c("v-text-field"),y=c("v-row"),r=c("vxe-column"),F=c("vxe-table"),I=c("v-window-item"),C=c("v-window"),x=c("v-card-text"),P=c("v-card");return W(),Y("div",te,[u("div",null,[t(P,{class:"mt-5"},{default:l(()=>[t(x,null,{default:l(()=>[t(C,{modelValue:e.activeTab,"onUpdate:modelValue":i[3]||(i[3]=s=>e.activeTab=s)},{default:l(()=>[t(I,null,{default:l(()=>[u("div",ae,[t(y,{"no-gutters":""},{default:l(()=>[t(m,{cols:"3",class:"col"},{default:l(()=>[t(K,{"authority-list":e.authorityList,"btn-list":e.btnList},null,8,["authority-list","btn-list"])]),_:1}),t(m,{cols:"9"},{default:l(()=>[t(y,{"no-gutters":"",onKeyup:T(o.sureSearch,["enter"])},{default:l(()=>[t(m,{cols:"4"},{default:l(()=>[t(f,{modelValue:e.searchForm.carrier,"onUpdate:modelValue":i[0]||(i[0]=s=>e.searchForm.carrier=s),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:a.$t("base.freightSetting.carrier"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),t(m,{cols:"4"},{default:l(()=>[t(f,{modelValue:e.searchForm.departure_city,"onUpdate:modelValue":i[1]||(i[1]=s=>e.searchForm.departure_city=s),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:a.$t("base.freightSetting.departure_city"),variant:"solo"},null,8,["modelValue","label"])]),_:1}),t(m,{cols:"4"},{default:l(()=>[t(f,{modelValue:e.searchForm.arrival_city,"onUpdate:modelValue":i[2]||(i[2]=s=>e.searchForm.arrival_city=s),clearable:"","hide-details":"",density:"comfortable",class:"searchInput ml-5 mt-1",label:a.$t("base.freightSetting.arrival_city"),variant:"solo"},null,8,["modelValue","label"])]),_:1})]),_:1},8,["onKeyup"])]),_:1})]),_:1})]),u("div",{class:"mt-5",style:Q({height:d(D)})},[t(F,{ref_key:"xTable",ref:h,"column-config":{minWidth:"100px"},data:e.tableData,height:d($),align:"center"},{empty:l(()=>[X(S(d(n).global.t("system.page.noData")),1)]),default:l(()=>[t(r,{type:"seq",width:"60"}),t(r,{type:"checkbox",width:"50"}),t(r,{field:"carrier",title:a.$t("base.freightSetting.carrier")},null,8,["title"]),t(r,{field:"departure_city",title:a.$t("base.freightSetting.departure_city")},null,8,["title"]),t(r,{field:"arrival_city",title:a.$t("base.freightSetting.arrival_city")},null,8,["title"]),t(r,{field:"price_per_weight",title:a.$t("base.freightSetting.price_per_weight")},null,8,["title"]),t(r,{field:"price_per_volume",title:a.$t("base.freightSetting.price_per_volume")},null,8,["title"]),t(r,{field:"min_payment",title:a.$t("base.freightSetting.min_payment")},null,8,["title"]),t(r,{field:"creator",title:a.$t("base.freightSetting.creator")},null,8,["title"]),t(r,{field:"create_time",width:"170px",formatter:["formatDate","yyyy-MM-dd HH:mm"],title:a.$t("base.freightSetting.create_time")},null,8,["title"]),t(r,{field:"is_valid",title:a.$t("base.freightSetting.is_valid")},{default:l(({row:s,column:_})=>[u("span",null,S(s[_.property]?a.$t("system.combobox.yesOrNo.yes"):a.$t("system.combobox.yesOrNo.no")),1)]),_:1},8,["title"]),t(r,{field:"operate",title:a.$t("system.page.operate"),width:"160",resizable:!1,"show-overflow":""},{default:l(({row:s})=>[t(v,{flat:!0,icon:"mdi-pencil-outline","tooltip-text":a.$t("system.page.edit"),disabled:!e.authorityList.includes("save"),onClick:_=>o.editRow(s)},null,8,["tooltip-text","disabled","onClick"]),t(v,{flat:!0,icon:"mdi-delete-outline","tooltip-text":a.$t("system.page.delete"),"icon-color":e.authorityList.includes("delete")?d(k):"",disabled:!e.authorityList.includes("delete"),onClick:_=>o.deleteRow(s)},null,8,["tooltip-text","icon-color","disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["data","height"]),t(z,{"current-page":e.tablePage.pageIndex,"page-size":e.tablePage.pageSize,perfect:"",total:e.tablePage.total,"page-sizes":d(M),layouts:d(N),onPageChange:o.handlePageChange},null,8,["current-page","page-size","total","page-sizes","layouts","onPageChange"])],4)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(G,{"show-dialog":e.showDialog,form:e.dialogForm,onClose:o.closeDialog,onSaveSuccess:o.saveSuccess},null,8,["show-dialog","form","onClose","onSaveSuccess"]),t(R,{"show-dialog":e.showDialogImport,onClose:o.closeDialogImport,onSaveSuccess:o.saveSuccessImport},null,8,["show-dialog","onClose","onSaveSuccess"])])])}}});const Fe=ee(oe,[["__scopeId","data-v-f3075937"]]);export{Fe as default};
